<div id="container">
  <div class="main"><div class="content clearfix"><div class="documentwrapper"><article class="document">
              
  <div id="contents" class="contents topic">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a href="#overview" id="id41" class="reference internal">Overview</a><ul>
<li><a href="#about-balanced" id="id42" class="reference internal">About Balanced</a></li>
<li><a href="#github-issues" id="id43" class="reference internal">Github Issues</a></li>
<li><a href="#popular-use-cases" id="id44" class="reference internal">Popular Use Cases</a></li>
<li><a href="#client-libraries" id="id45" class="reference internal">Client Libraries</a></li>
<li><a href="#support" id="id46" class="reference internal">Support</a></li>
</ul>
</li>
<li><a href="#pricing-and-fees" id="id47" class="reference internal">Pricing and fees</a><ul>
<li><a href="#payouts" id="id48" class="reference internal">Payouts</a></li>
<li><a href="#processing" id="id49" class="reference internal">Processing</a></li>
<li><a href="#invoicing-fees" id="id50" class="reference internal">Invoicing fees</a></li>
<li><a href="#funds-flow" id="id51" class="reference internal">Funds Flow</a></li>
</ul>
</li>
<li><a href="#getting-started" id="id52" class="reference internal">Getting Started</a><ul>
<li><a href="#tokenizing-sensitive-information" id="id53" class="reference internal">Tokenizing Sensitive Information</a></li>
<li><a href="#client-side-validation-helpers" id="id54" class="reference internal">Client-side Validation Helpers</a></li>
<li><a href="#forms" id="id55" class="reference internal">Forms</a></li>
</ul>
</li>
<li><a href="#balanced-payouts" id="id56" class="reference internal">Balanced Payouts</a><ul>
<li><a href="#tutorial" id="id57" class="reference internal">Tutorial</a></li>
<li><a href="#credit-s-status-field" id="id58" class="reference internal">Credit's Status Field</a></li>
<li><a href="#payout-methods" id="id59" class="reference internal">Payout Methods</a></li>
<li><a href="#canceling-credits" id="id60" class="reference internal">Canceling Credits</a></li>
<li><a href="#pre-funding-your-account" id="id61" class="reference internal">Pre-funding Your Account</a></li>
<li><a href="#testing" id="id62" class="reference internal">Testing</a></li>
<li><a href="#submission-delivery-times" id="id63" class="reference internal">Submission &amp; Delivery times</a></li>
<li><a href="#best-practices" id="id64" class="reference internal">Best Practices</a></li>
</ul>
</li>
<li><a href="#balanced-processing" id="id65" class="reference internal">Balanced Processing</a><ul>
<li><a href="#id17" id="id66" class="reference internal">Tutorial</a></li>
<li><a href="#refunds" id="id67" class="reference internal">Refunds</a></li>
<li><a href="#holds" id="id68" class="reference internal">Holds</a></li>
<li><a href="#processing-testing" id="id69" class="reference internal">Testing</a></li>
<li><a href="#id32" id="id70" class="reference internal">Best Practices</a></li>
</ul>
</li>
<li><a href="#debiting-bank-accounts" id="id71" class="reference internal">Debiting Bank Accounts</a><ul>
<li><a href="#id37" id="id72" class="reference internal">Tutorial</a></li>
</ul>
</li>
<li><a href="#id38" id="id73" class="reference internal">Marketplaces</a><ul>
<li><a href="#merchant-underwriting" id="id74" class="reference internal">Merchant Underwriting</a></li>
<li><a href="#associating-debits-with-a-merchant" id="id75" class="reference internal">Associating debits with a merchant</a></li>
</ul>
</li>
<li><a href="#references" id="id76" class="reference internal">References</a><ul>
<li><a href="#storing-the-uri-vs-id" id="id77" class="reference internal">Storing the URI vs ID</a></li>
<li><a href="#id40" id="id78" class="reference internal">Old Documentation</a></li>
<li><a href="#api-reference" id="id79" class="reference internal">API Reference</a></li>
</ul>
</li>
</ul>
</div>
<div class="langbar sphinxcontainer">
<p>Clients:</p>
<ul class="simple">
<li>curl</li>
<li>ruby</li>
<li>python</li>
<li>php</li>
</ul>
</div>
<div class="lead alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p>Please excuse our layout as we overhaul our documentation.</p>
<ul class="last simple">
<li>Click here for our <a href="https://docs2.balancedpayments.com/api?old" class="reference external">**OLD** documentation</a></li>
</ul>
</div>
<div class="section">
<h1><span class="bookmark" id="overview"></span>Overview<a href="#overview" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<div class="section">
<h2><span class="bookmark" id="about-balanced"></span>About Balanced<a href="#about-balanced" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Balanced is a payments company that enables entrepreneurs and developers
to create new and amazing e-commerce experiences. We&#8217;ve built a
white-labeled API and web-based dashboard to help them do this.
Specifically, we offer two products: Balanced Payouts and Balanced
Processing, which can be coupled. We really like working with
marketplaces and crowd-funding platforms, but Balanced can be used for
any type of e-commerce model. You should use Balanced to charge your
buyers&#8217; credit cards and/or pay out to your sellers&#8217; US-based bank
accounts via <a href="http://en.wikipedia.org/wiki/Automated_Clearing_House" class="reference external">ACH</a>.</p>
<p>We&#8217;ve been processing live transactions since October, 2010 and have a
history of working closely with our customers to solve their problems,
specifically those related to multi-party transactions. For example,
we&#8217;re in an <a href="http://blog.gittip.com/post/28351995405/open-partnerships" class="reference external">open partnership</a> with <a href="http://gittip.com" class="reference external">Gittip</a> after volunteering code
and expertise to help them <a href="https://github.com/whit537/www.gittip.com/issues/67" class="reference external">mitigate the risks of running a
marketplace</a>. To date, Balanced has contributed to Gittip&#8217;s <a href="https://github.com/whit537/www.gittip.com/pull/137" class="reference external">payments
infrastructure</a>, <a href="https://github.com/whit537/www.gittip.com/issues/66#issuecomment-7439689" class="reference external">visual design</a>, and <a href="https://github.com/gvenkataraman/www.gittip.com/commit/ceb88e6f5e1eb7ae931cf2921866beccb49381b5" class="reference external">fraud preventions systems</a>.</p>
<p>Balanced believes in openness and transparency, so, despite being a
payments company, we try to discuss as much of our product development
decisions in public as possible. We&#8217;ve even <a href="https://github.com/balanced/balanced-api/issues/48" class="reference external">discussed pricing
decisions</a> publicly with our customers.</p>
</div>
<div class="section">
<h2><span class="bookmark" id="github-issues"></span>Github Issues<a href="#github-issues" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>We actively and publicly discuss feature requests and product decisions
with our community on <a href="https://github.com/balanced/balanced-api/issues" class="reference external">github</a>. We&#8217;d love to hear from you.</p>
</div>
<div class="section">
<h2><span class="bookmark" id="popular-use-cases"></span>Popular Use Cases<a href="#popular-use-cases" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<div class="section">
<h3><span class="bookmark" id="marketplaces"></span>Marketplaces<a href="#marketplaces" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Balanced is most often used to power payments for online and mobile
marketplaces -- any platform facilitating payments between buyers and
sellers. For example, <a href="http://kitchit.com" class="reference external">kitchit</a>, <a href="http://copious.com" class="reference external">copious</a>, <a href="http://zaarly.com" class="reference external">zaarly</a>, <a href="http://visual.ly" class="reference external">visual.ly</a>,
and many others are connecting Balanced Processing and Balanced Payouts
to charge a buyer&#8217;s credit card on behalf of a seller.</p>
<p>Some customers have even implemented a shopping cart checkout flow where
a single buyer can buy from many sellers with a single transaction. And
holding the funds with Balanced between Payouts and Processing can allow
the marketplace to implement an escrow-like functionality.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="crowd-funding"></span>Crowd-funding<a href="#crowd-funding" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Balanced is commonly used to power payments for crowd-funding and group
purchasing platforms. For example, <a href="http://crowdtilt.com" class="reference external">crowdtilt</a>, <a href="http://wanderable.com" class="reference external">wanderable</a>,
<a href="http://gittip.com" class="reference external">gittip</a>, and many others are connecting Balanced Processing and
Balanced Payouts to charge many buyers&#8217; credit cards on behalf of a
single seller.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="vendor-payments"></span>Vendor Payments<a href="#vendor-payments" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Balanced Payouts is used by many businesses that need to pay their
sellers or vendors for supplies and services rendered.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="e-commerce"></span>e-Commerce<a href="#e-commerce" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Balanced Processing is used by a merchants to simply charge buyers for
items they sell directly.</p>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="client-libraries"></span>Client Libraries<a href="#client-libraries" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Balanced attempts very hard to write idiomatic code for all it's API libraries
and we pride ourselves in an extensive test suite for every client that
demonstrates almost every single method / function executed for your
convenience.</p>
<p>We find that this is the best way to use the client libraries. If you encounter
and issue, please file a github issue and get in touch through one our
many <a href="#support" class="reference internal"><em>support channels</em></a>.</p>
<table border="1" class="docutils">
<caption>API Libraries</caption>
<colgroup>
<col width="15%">
<col width="31%">
<col width="31%">
<col width="23%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Language</th>
<th class="head">Repository</th>
<th class="head">Tests</th>
<th class="head">Primary Contributor</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>python</td>
<td><a href="https://github.com/balanced/balanced-python" class="reference external">balanced-python</a></td>
<td><a href="https://github.com/balanced/balanced-python/tree/master/tests" class="reference external">balanced-python tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-odd"><td>ruby</td>
<td><a href="https://github.com/balanced/balanced-ruby" class="reference external">balanced-ruby</a></td>
<td><a href="https://github.com/balanced/balanced-ruby/tree/master/spec" class="reference external">balanced-ruby tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-even"><td>php</td>
<td><a href="https://github.com/balanced/balanced-php" class="reference external">balanced-php</a></td>
<td><a href="https://github.com/balanced/balanced-php/tree/master/tests" class="reference external">balanced-php tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-odd"><td>java</td>
<td><a href="https://github.com/balanced/balanced-java" class="reference external">balanced-java</a></td>
<td><a href="https://github.com/balanced/balanced-java/tree/master/src/test" class="reference external">balanced-java tests</a></td>
<td>Balanced</td>
</tr>
<tr class="row-even"><td>perl</td>
<td><a href="https://github.com/Crowdtilt/Business-BalancedPayments" class="reference external">Business-BalancedPayments</a></td>
<td><a href="https://github.com/Crowdtilt/Business-BalancedPayments/tree/master/t" class="reference external">Business-BalancedPayments tests</a></td>
<td><a href="http://crowdtilt.com" class="reference external">Crowdtilt.com</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h2><span class="bookmark" id="support"></span><span class="bookmark" id="id1"></span>Support<a href="#support" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>We respond to support requests and questions through several channels
including:</p>
<ul class="simple">
<li><a href="http://webchat.freenode.net/?channels=balanced&amp;uio=MTE9OTIaf" class="reference external">IRC</a> for real-time answers to technical support questions</li>
<li><a href="https://stackoverflow.com/questions/tagged/balanced-payments" class="reference external">Stackoverflow</a> for technical questions</li>
<li><a href="https://quora.com/balanced" class="reference external">Quora</a> for product and business questions</li>
<li>Email: <a href="mailto:support%40balancedpayments.com" class="reference external">support<span>@</span>balancedpayments<span>.</span>com</a></li>
</ul>
<p>Follow <a href="https://twitter.com/balancedstatus" class="reference external">@balancedstatus</a> or check out <a href="https://status.balancedpayments.com/" class="reference external">status.balancedpayments.com</a>
for real-time status updates on the API, <tt class="docutils literal"><span class="pre">balanced.js</span></tt>, and Balanced&#8217;s
dashboard.</p>
<p>Join the Balanced <a href="https://www.balancedpayments.com/community" class="reference external">community</a> and follow us on <a href="https://twitter.com/balanced" class="reference external">Twitter</a>.</p>
</div>
</div>
<div class="section">
<h1><span class="bookmark" id="pricing-and-fees"></span>Pricing and fees<a href="#pricing-and-fees" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<p>You will pay a fee of 25&#162; when you successfully payout to a seller&#8217;s
bank account, and 2.9% + 30&#162; when you successfully charge a buyer&#8217;s
credit card. We try to keep our pricing straightforward, so Balanced
does not charge any fees besides those listed here.</p>
<div class="section">
<h2><span class="bookmark" id="payouts"></span>Payouts<a href="#payouts" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>It costs just simply 25&#162; to issue a next day ACH credit. Our full
fee per operation is listed below:</p>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="65%">
<col width="35%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">operation</th>
<th class="head">cost to you</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>next-day ACH</td>
<td>25&#162;</td>
</tr>
<tr class="row-odd"><td>failure</td>
<td>$3.50</td>
</tr>
<tr class="row-even"><td>reversal</td>
<td>$0</td>
</tr>
<tr class="row-odd"><td>batch fee</td>
<td>$0</td>
</tr>
<tr class="row-even"><td>monthly fee</td>
<td>$0</td>
</tr>
<tr class="row-odd"><td>set-up fee</td>
<td>$0</td>
</tr>
<tr class="row-even"><td>payouts to your bank account</td>
<td>$0</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h2><span class="bookmark" id="processing"></span>Processing<a href="#processing" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Balanced Processing costs just 2.9% and 30&#162; per successful charge. Our full
fee per operation is listed below:</p>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="65%">
<col width="35%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">operation</th>
<th class="head">cost to you</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>successful charge</td>
<td>2.9% + 30&#162;</td>
</tr>
<tr class="row-odd"><td>chargeback</td>
<td>$15.00</td>
</tr>
<tr class="row-even"><td>refund</td>
<td>$0</td>
</tr>
<tr class="row-odd"><td>failure</td>
<td>$0</td>
</tr>
<tr class="row-even"><td>batch fee</td>
<td>$0</td>
</tr>
<tr class="row-odd"><td>monthly fee</td>
<td>$0</td>
</tr>
<tr class="row-even"><td>set-up fee</td>
<td>$0</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h2><span class="bookmark" id="invoicing-fees"></span><span class="bookmark" id="overview-fees-balanced"></span>Invoicing fees<a href="#invoicing-fees" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Balanced will create invoices to collect fees daily. These invoices can be
viewed under the <tt class="docutils literal"><span class="pre">invoices</span></tt> tab of the Balanced dashboard. These fees are
debited from the bank account attached to the owner account of the
marketplace. Please note that Balanced will never take fees from the operating
capital (escrow account) of the marketplace.</p>
<ul class="simple">
<li>A buyer pays for a service on Monday from a third-party merchant. You charge
the buyer $10, which increases your escrow balance by $10.<ul>
<li>Balanced will invoice you, on Monday for 2.9% of $10 (or 29&#162;), plus 30&#162;,
and debit your bank account for a total of 59&#162;.</li>
</ul>
</li>
<li>On Wednesday, the third-party merchant completes performing a service for the
buyer, and the buyer acknowledges this. You credit out payment to the
merchant, likely keeping a portion to pay your fees. Perhaps you pay out $7
to the merchant, leaving you with $3 in your escrow account.<ul>
<li>Balanced will invoice you, on Wednesday, 25&#162; for this ACH credit.</li>
</ul>
</li>
<li>The $3 that is left from the buyer's $10 is your revenue from this order. You
decide to credit this to your own bank account on Friday.<ul>
<li>Balanced doesn't charge you for this credit, as credits to owner accounts
are free.</li>
</ul>
</li>
</ul>
</div>
<div class="section">
<h2><span class="bookmark" id="funds-flow"></span>Funds Flow<a href="#funds-flow" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>It's important to understand how the funds flow works on Balanced. First and
foremost, when a charge occurs on Balanced, the amount you've charged your
user is the exact amount that shows up in the balance.</p>
<div class="section">
<h3><span class="bookmark" id="escrow"></span><span class="bookmark" id="mp-escrow"></span>Escrow<a href="#escrow" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Once a card is successfully charged your funds are implicitly in escrow for
your marketplace. This gives you complete control on funds disbursement.</p>
<p>You may choose to keep the money in escrow for as long as you desire
- but the common use case for this is to wait for any type of fulfillment
from your merchants -- such as confirmation of a shipped product or
completion of a service.</p>
<p>Since <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a> delivers funds to your merchant within
one (1) business day, you can get a bit more creative as well. For example,
you may stagger the funds for disbursement at different times during the order
process - for example:</p>
<ul class="simple">
<li>A buyer has paid for a service</li>
<li>Your merchant needs half of the payout amount as working capital</li>
<li>You issue 50% of the amount you charged the buyer as a credit to the merchant
using <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a></li>
<li>The merchant performs the service and buyer is happy with the service</li>
<li>You can pay the other half post completion of the service</li>
</ul>
<p>In today's growing collaborative consumption economy, this model is extremely
powerful for providing marketplace liquidity to enable new forms of commerce.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="collecting-your-fees"></span>Collecting Your Fees<a href="#collecting-your-fees" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Now that you've understood how incoming money comes in to Balanced and the
concept of implicit escrow, you might ask yourself, "where do I take my
cut?"</p>
<p>Since incoming funds are not touched by Balanced, you must issue a credit to
your own bank account with the funds you want for yourself -- that means you
must do the math to calculate the difference.</p>
<p>There are three common scenarios:</p>
<ol class="arabic simple">
<li>adding your business' fee to the total amount charged during checkout</li>
</ol>
<ol start="2" class="arabic simple">
<li>with-holding some of the funds from the merchant and diverting those funds to yourself</li>
</ol>
<ol start="3" class="arabic simple">
<li>doing both of these :)</li>
</ol>
<p>Here are some examples that can clarify these scenarios, but first let's give
a little context:</p>
<p>Let's say you have a marketplace called <strong>RentMyBike</strong> <a href="#id3" id="id2" class="footnote-reference">[1]</a>, which provides
a platform for bike owners, a.k.a. merchants, to put their bikes for rent by
renters, a.k.a. the buyers.</p>
<p>Recap:</p>
<ul class="simple">
<li>The bike owners are the merchants.</li>
<li>The renters are the buyers.</li>
<li>Your marketplace is called Rent By Bike</li>
</ul>
<table rules="none" frame="void" id="id3" class="docutils footnote">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a href="#id2" class="fn-backref">[1]</a></td><td>Our sample marketplace is actually called <a href="https://rentmybike.co" class="reference external">Rent My Bike</a> :)</td></tr>
</tbody>
</table>
<div class="section">
<h4><span class="bookmark" id="fee-scenario-1"></span>Fee Scenario #1<a href="#fee-scenario-1" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>Your marketplace listing fee is 10%. So, say Alice lists her bike for 100.00$.
Bob decides to rent this bike - costing him $100.00.</p>
<ul class="simple">
<li>You charge Bob $100.00</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $100.00</li>
<li>Alice delivers the bike to Bob</li>
<li>You issue a $90.00 credit to Alice, using <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a><ul>
<li>Your listing fee is 10%, so 90% of $100.00 is $90.00</li>
</ul>
</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $10.00</li>
<li>You issue a credit to your own bank account, using <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a></li>
<li>Your money is in your bank account next business day</li>
<li>Alice's money is in her bank account next business day</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $0.00</li>
</ul>
</div>
<div class="section">
<h4><span class="bookmark" id="fee-scenario-2"></span>Fee Scenario #2<a href="#fee-scenario-2" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>Your marketplace renting fee is 10%. So, say Alice lists her bike for 100.00$.
Bob decides to rent this bike - costing him $110.00.</p>
<ul class="simple">
<li>You charge Bob $110.00<ul>
<li>Your renting fee is 10%, so $100.00 * 1.10 = $110.00 is how how much to charge Bob</li>
</ul>
</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $110.00</li>
<li>Alice delivers the bike to Bob</li>
<li>You issue a $100.00 credit to Alice, using <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a></li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $10.00</li>
<li>You issue a credit for $10.00 to your own bank account, using <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a></li>
<li>Your money is in your bank account next business day</li>
<li>Alice's money is in her bank account next business day</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $0.00</li>
</ul>
</div>
<div class="section">
<h4><span class="bookmark" id="fee-scenario-3"></span>Fee Scenario #3<a href="#fee-scenario-3" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>Your marketplace renting fee is 10%. You also charge a 10% listing fee.</p>
<p>So, say Alice lists her bike for 100.00$. Bob decides to rent this
bike - costing him $110.00.</p>
<ul class="simple">
<li>You charge Bob $110.00<ul>
<li>Your renting fee is 10%, so $100.00 * 1.10 = $110.00 is how how much to charge Bob</li>
</ul>
</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $110.00</li>
<li>Alice delivers the bike to Bob</li>
<li>You issue a $90.00 credit to Alice, using <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a><ul>
<li>Your listing fee is 10%, so 90% of $100.00 is $90.00</li>
</ul>
</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $20.00</li>
<li>You issue a credit for $20.00 to your own bank account, using <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a></li>
<li>Your money is in your bank account next business day</li>
<li>Alice's money is in her bank account next business day</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance now shows $0.00</li>
</ul>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="crediting-your-seller-s-bank-account"></span>Crediting Your Seller's Bank Account<a href="#crediting-your-seller-s-bank-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
</div>
<div class="section">
<h3><span class="bookmark" id="crediting-your-own-merchant-account"></span>Crediting Your Own Merchant Account<a href="#crediting-your-own-merchant-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
</div>
</div>
</div>
<div class="section">
<h1><span class="bookmark" id="getting-started"></span><span class="bookmark" id="tokenization"></span>Getting Started<a href="#getting-started" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<div class="section">
<h2><span class="bookmark" id="tokenizing-sensitive-information"></span>Tokenizing Sensitive Information<a href="#tokenizing-sensitive-information" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Balanced provides a PCI-compliant javascript library, dubbed <tt class="docutils literal"><span class="pre">balanced.js</span></tt>
which, when included on your website, enables secure collection of payment and
sensitive information without touching your servers, keeping you completely
outside of PCI and regulatory scope.</p>
<p>This getting started is a reference to <tt class="docutils literal"><span class="pre">balanced.js</span></tt> and for your convenience
we've built a <a href="https://gist.github.com/2662770" class="reference external">full example page</a> that's already put together for you. We're putting
this here as we're going to reference it in the <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a> and the <a href="#id16" class="reference internal"><em>Balanced Processing</em></a>
tutorials.</p>
<p>Here's another <a href="http://jsfiddle.net/mahmoudimus/DGDkt/11/" class="reference external">jsFiddle demo</a> that demonstrates bank account tokenization and we've also got a <a href="http://jsfiddle.net/mjallday/BtXfr/" class="reference external">jsFiddle for tokenizing cards</a>.</p>
<div class="section">
<h3><span class="bookmark" id="including"></span><span class="bookmark" id="tok-including"></span>Including<a href="#including" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Securely collecting information has never been easier, just include the
following script on your page.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"https://js.balancedpayments.com/v1/balanced.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>
</div>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This may not work on very old browsers. For more information on how to
support older browsers, <a href="http://www.quirksmode.org/js/placejs.html" class="reference external">quirksmode</a> provides a tutorial on how to get
javascript <tt class="docutils literal"><span class="pre">&lt;script&gt;</span></tt> includes to play nicely.</p>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="initializing"></span><span class="bookmark" id="tok-init"></span>Initializing<a href="#initializing" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>In a separate script tag, after you've <a href="#tok-including" class="reference internal"><em>included balanced.js</em></a>,
set your marketplace uri. This essentially acts as your public key and it's
OK to freely share this with anyone.</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span><span class="nt">&gt;</span>
    <span class="nx">balanced</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="s1">'marketplaceUri'</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<p>OK, you're ready to rock and roll!</p>
</div>
<div class="section">
<h3><span class="bookmark" id="create-a-card"></span>Create a Card<a href="#create-a-card" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Creating a card is as easy as constructing a object with a card's details
and invoking the <tt class="docutils literal"><span class="pre">balanced.card.create</span></tt> function.</p>
<p>Here's an example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">cardData</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Bernhard Riemann"</span><span class="p">,</span>                 <span class="c1">// Optional</span>
  <span class="s2">"card_number"</span><span class="o">:</span> <span class="s2">"4111 1111 1111 1111"</span><span class="p">,</span>
  <span class="s2">"expiration_month"</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="s2">"expiration_year"</span><span class="o">:</span> <span class="mi">2014</span><span class="p">,</span>
<span class="p">};</span>


<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">cardData</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">alert</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>That will actually hit Balanced's servers and if successful, will tokenize
a card for you. More on that later, but first, let's discuss how to handle
the returned results from Balanced.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="the-callback"></span><span class="bookmark" id="tok-callback"></span>The Callback<a href="#the-callback" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>The second parameter just did a dummy <tt class="docutils literal"><span class="pre">alert()</span></tt> for demonstration purposes,
but this function is actually the most important piece of the integration. It is
your Balanced response handler. It takes one parameter that has three (3)
properties which you can use to drive the interaction with Balanced:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">data</span></tt> - An object representing a tokenized resource (card or bank account).</li>
<li><tt class="docutils literal"><span class="pre">error</span></tt> - Details of the error, if any.</li>
<li><tt class="docutils literal"><span class="pre">status</span></tt> - The HTTP response code of the tokenization operation.</li>
</ul>
<p>Here's a skeleton callback function that we can use to get started:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">callbackHandler</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">switch</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
       <span class="k">case</span> <span class="mi">201</span><span class="o">:</span>
           <span class="c1">// WOO HOO!</span>
           <span class="c1">// response.data.uri == uri of the card or bank account resource</span>
           <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="mi">400</span><span class="o">:</span>
           <span class="c1">// missing field - check response.error for details</span>
           <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="mi">402</span><span class="o">:</span>
           <span class="c1">// we couldn't authorize the buyer's credit card</span>
           <span class="c1">// check response.error for details</span>
           <span class="k">break</span>
       <span class="k">case</span> <span class="mi">404</span><span class="o">:</span>
           <span class="c1">// your marketplace URI is incorrect</span>
           <span class="k">break</span><span class="p">;</span>
       <span class="k">case</span> <span class="mi">500</span><span class="o">:</span>
           <span class="c1">// Balanced did something bad, please retry the request</span>
           <span class="k">break</span><span class="p">;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So, let's show that example on creating a card again, but this time with a
proper callback handler:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">cardData</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Bernhard Riemann"</span><span class="p">,</span>                 <span class="c1">// Optional</span>
  <span class="s2">"card_number"</span><span class="o">:</span> <span class="s2">"4111 1111 1111 1111"</span><span class="p">,</span>
  <span class="s2">"expiration_month"</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="s2">"expiration_year"</span><span class="o">:</span> <span class="mi">2014</span><span class="p">,</span>
<span class="p">};</span>

<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">cardData</span><span class="p">,</span> <span class="nx">callbackHandler</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="create-a-bank-account"></span>Create a Bank Account<a href="#create-a-bank-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Just like creating a card, creating a bank account is very simple - just build
up an object and invoke the <tt class="docutils literal"><span class="pre">balanced.bankAccount.create</span></tt> function.</p>
<p>Here's an example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">bankAccountData</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Levain Bakery LLC"</span><span class="p">,</span>
   <span class="s2">"account_number"</span><span class="o">:</span> <span class="s2">"28304871049"</span><span class="p">,</span>
   <span class="s2">"routing_number"</span><span class="o">:</span> <span class="s2">"121042882"</span>
<span class="p">}</span>

<span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">bankAccountData</span><span class="p">,</span> <span class="nx">callbackHandler</span><span class="p">);</span>
</pre></div>
</div>
<p>Notice that we used the same <a href="#tok-callback" class="reference internal"><em>callback handler</em></a> as
tokenizing a card.</p>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="client-side-validation-helpers"></span><span class="bookmark" id="tok-validators"></span>Client-side Validation Helpers<a href="#client-side-validation-helpers" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p><tt class="docutils literal"><span class="pre">balanced.js</span></tt> includes a number of helpers that can help verify both
credit card and bank account information. Using these helpers when building your
forms adds robustness, boosting your website's user experience and dramatically
reducing declinations.</p>
<div class="section">
<h3><span class="bookmark" id="card-validation"></span>Card Validation<a href="#card-validation" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Validates a card number by checking if it's formatted correctly and
passes the standard <a href="http://en.wikipedia.org/wiki/Luhn_algorithm" class="reference external">Luhn check</a>. All whitespace and non-numeric data is
stripped for convenience.</p>
<dl class="function">
<dt id="balanced.card.isCardNumberValid">
<tt class="descclassname">balanced.card.</tt><tt class="descname">isCardNumberValid</tt><big>(</big><em>cardNumber</em><big>)</big><a href="#balanced.card.isCardNumberValid" class="headerlink" title="Permalink to this definition">&#8757;</a></dt>
<dd><table rules="none" frame="void" class="docutils field-list">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>cardNumber</strong> -- the card number to Luhn validate.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">true</span></tt> if the card number matches <a href="http://en.wikipedia.org/wiki/Luhn_algorithm" class="reference external">Luhn check</a>, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">);</span>       <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'4111 1111 1111 1111'</span><span class="p">);</span>    <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'4111-1111-1111-1111'</span><span class="p">);</span>    <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isCardNumberValid</span><span class="p">(</span><span class="s1">'42123'</span><span class="p">);</span>                  <span class="c1">// false</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="determining-card-brand"></span>Determining Card Brand<a href="#determining-card-brand" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Returns the card brand, calculated from the card number. If the card brand can
NOT be determined, it will return <tt class="docutils literal"><span class="pre">null</span></tt>.</p>
<dl class="function">
<dt id="balanced.card.cardType">
<tt class="descclassname">balanced.card.</tt><tt class="descname">cardType</tt><big>(</big><em>cardNumber</em><big>)</big><a href="#balanced.card.cardType" class="headerlink" title="Permalink to this definition">&#8757;</a></dt>
<dd><table rules="none" frame="void" class="docutils field-list">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>cardNumber</strong> -- the card number to determine the brand for.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">Mastercard</span></tt>, <tt class="docutils literal"><span class="pre">American</span> <span class="pre">Express</span></tt>, <tt class="docutils literal"><span class="pre">VISA</span></tt>, <tt class="docutils literal"><span class="pre">Discover</span> <span class="pre">Card</span></tt>, or <tt class="docutils literal"><span class="pre">null</span></tt></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="s1">'5105105105105100'</span><span class="p">);</span>   <span class="c1">// Mastercard</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">);</span>   <span class="c1">// VISA</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="s1">'341111111111111'</span><span class="p">);</span>    <span class="c1">// American Express</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">cardType</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                     <span class="c1">// null</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="validating-the-security-code-csc"></span>Validating the Security Code (CSC)<a href="#validating-the-security-code-csc" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Checks whether or not the supplied number could be a valid card security code
for the supplied card number.</p>
<dl class="function">
<dt id="balanced.card.isSecurityCodeValid">
<tt class="descclassname">balanced.card.</tt><tt class="descname">isSecurityCodeValid</tt><big>(</big><em>cardNumber</em>, <em>securityCode</em><big>)</big><a href="#balanced.card.isSecurityCodeValid" class="headerlink" title="Permalink to this definition">&#8757;</a></dt>
<dd><table rules="none" frame="void" class="docutils field-list">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>cardNumber</strong> -- the card number to determine the validate the security code for.</li>
<li><strong>securityCode</strong> -- the security number to validate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">true</span></tt> if the csc is valid for the card number provided, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isSecurityCodeValid</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>   <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isSecurityCodeValid</span><span class="p">(</span><span class="s1">'4111111111111111'</span><span class="p">,</span> <span class="mi">9999</span><span class="p">)</span>  <span class="c1">// false</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="validating-card-expiration"></span>Validating Card Expiration<a href="#validating-card-expiration" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Returns true if <tt class="docutils literal"><span class="pre">expirationMonth</span></tt> and <tt class="docutils literal"><span class="pre">expirationYear</span></tt> correspond to
a date in the future.</p>
<dl class="function">
<dt id="balanced.card.isExpiryValid">
<tt class="descclassname">balanced.card.</tt><tt class="descname">isExpiryValid</tt><big>(</big><em>expirationMonth</em>, <em>expirationYear</em><big>)</big><a href="#balanced.card.isExpiryValid" class="headerlink" title="Permalink to this definition">&#8757;</a></dt>
<dd><table rules="none" frame="void" class="docutils field-list">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>expirationMonth</strong> -- the expiration month to validate</li>
<li><strong>expirationYear</strong> -- the expiration year to validate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">true</span></tt> if the expiration date is in the future, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isExpiryValid</span><span class="p">(</span><span class="s1">'01'</span><span class="p">,</span> <span class="s1">'2020'</span><span class="p">);</span>    <span class="c1">// true</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">isExpiryValid</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2010</span><span class="p">);</span>         <span class="c1">// false</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="general-card-validation"></span>General Card Validation<a href="#general-card-validation" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Performs a suite of checks on the submitted credit card data and returns
a dictionary of errors. Will return an empty dictionary if there are no
errors.</p>
<dl class="function">
<dt id="balanced.card.validate">
<tt class="descclassname">balanced.card.</tt><tt class="descname">validate</tt><big>(</big><em>{card_number</em>, <em>security_code</em>, <em>expiration_month</em>, <em>expiration_year}</em><big>)</big><a href="#balanced.card.validate" class="headerlink" title="Permalink to this definition">&#8757;</a></dt>
<dd><table rules="none" frame="void" class="docutils field-list">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>card_number</strong> -- the card number to validate</li>
<li><strong>security_code</strong> -- the security code to validate</li>
<li><strong>expiration_month</strong> -- the expiration month to validate</li>
<li><strong>expiration_year</strong> -- the expiration year to validate</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">{}</span></tt> if all fields are valid, else a dictionary of errors otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">validate</span><span class="p">({</span>
  <span class="nx">card_number</span><span class="o">:</span><span class="s1">'4111111111111111'</span><span class="p">,</span>
  <span class="nx">expiration_month</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
  <span class="nx">expiration_year</span><span class="o">:</span><span class="mi">2000</span><span class="p">,</span>
  <span class="nx">security_code</span><span class="o">:</span><span class="mi">123</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Will return:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="nx">expiration</span><span class="o">:</span> <span class="s1">'"1-2000" is not a valid credit card expiration date'</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="validate-a-bank-account-s-routing-number"></span><span class="bookmark" id="tok-validators-banks"></span>Validate a Bank Account's Routing Number<a href="#validate-a-bank-account-s-routing-number" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Validates a USA based bank routing number using the <a href="http://en.wikipedia.org/wiki/Routing_transit_number#MICR_Routing_number_format" class="reference external">MICR Routing Number
Format</a>.</p>
<dl class="function">
<dt id="balanced.bankAccount.validateRoutingNumber">
<tt class="descclassname">balanced.bankAccount.</tt><tt class="descname">validateRoutingNumber</tt><big>(</big><em>routingNumber</em><big>)</big><a href="#balanced.bankAccount.validateRoutingNumber" class="headerlink" title="Permalink to this definition">&#8757;</a></dt>
<dd><table rules="none" frame="void" class="docutils field-list">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>routingNumber</strong> -- a 9 digit routing number, can have a leading zero!</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">true</span></tt> if the routing number check digit matches, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validateRoutingNumber</span><span class="p">(</span><span class="s1">'321174851'</span><span class="p">)</span> <span class="c1">// passes</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validateRoutingNumber</span><span class="p">(</span><span class="s1">'021000021'</span><span class="p">)</span> <span class="c1">// passes</span>
<span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validateRoutingNumber</span><span class="p">(</span><span class="s1">'123457890'</span><span class="p">)</span> <span class="c1">// fails</span>
</pre></div>
</div>
<div class="alert admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The success of this method does not guarantee that the
routing number is valid, only that it falls within a valid range.</p>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="general-bank-account-validation"></span>General Bank Account Validation<a href="#general-bank-account-validation" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="alert alert-warning admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Account numbers can not be validated in real time. More on
<a href="#payouts-best-practices" class="reference internal"><em>bank accounts best practices</em></a>.</p>
</div>
<p>Performs a suite of checks on the submitted bank account data and
returns a dictionary of errors. Will return an empty dictionary if there
are no errors.</p>
<dl class="function">
<dt id="balanced.bankAccount.validate">
<tt class="descclassname">balanced.bankAccount.</tt><tt class="descname">validate</tt><big>(</big><em>{bank_code</em>, <em>account_number</em>, <em>name}</em><big>)</big><a href="#balanced.bankAccount.validate" class="headerlink" title="Permalink to this definition">&#8757;</a></dt>
<dd><table rules="none" frame="void" class="docutils field-list">
<colgroup><col class="field-name">
<col class="field-body">
</colgroup><tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>bank_code</strong> -- the bank routing number to validate</li>
<li><strong>account_number</strong> -- the account number to perform a sanity check on</li>
<li><strong>name</strong> -- the name on the bank account to perform a sanity check on</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">{}</span></tt> if all fields are valid, else a dictionary of errors otherwise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">validate</span><span class="p">({</span>
    <span class="nx">bank_code</span><span class="o">:</span><span class="s1">'321174851'</span><span class="p">,</span>
    <span class="nx">account_number</span><span class="o">:</span><span class="s1">'09877765432111111'</span><span class="p">,</span>
    <span class="nx">name</span><span class="o">:</span><span class="s1">'Tommy Q. CopyPasta'</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="forms"></span>Forms<a href="#forms" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>For the purposes of various examples throughout this documentation,
we've provided you with two sample forms, one to collect card information
and one to collect bank account information.</p>
<p>We're also going to be using <a href="http://www.jquery.com" class="reference external">jQuery</a> throughout the examples for brevity, but
but <tt class="docutils literal"><span class="pre">balanced.js</span></tt> has no such dependency itself.</p>
<p>Remember, you can always use the <a href="https://gist.github.com/2662770" class="reference external">full example page</a> that already puts all
of this together or can ask us to write a sample form for you through one
of our <a href="#support" class="reference internal"><em>support channels</em></a>.</p>
<div class="section">
<h3><span class="bookmark" id="simple-card-form"></span><span class="bookmark" id="tok-card-form"></span>Simple Card Form<a href="#simple-card-form" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"#"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"credit-card-form"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;fieldset&gt;</span>
        <span class="nt">&lt;legend&gt;</span>Credit Card Details<span class="nt">&lt;/legend&gt;</span>
        <span class="nt">&lt;label&gt;</span>Card Number
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
                   <span class="na">autocomplete=</span><span class="s">"off"</span>
                   <span class="na">placeholder=</span><span class="s">"Card Number"</span>
                   <span class="na">class=</span><span class="s">"cc-number"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;label&gt;</span>Expiration
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
                   <span class="na">autocomplete=</span><span class="s">"off"</span>
                   <span class="na">placeholder=</span><span class="s">"Expiration Month"</span>
                   <span class="na">class=</span><span class="s">"cc-em"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;span&gt;</span>/<span class="nt">&lt;/span&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
                   <span class="na">autocomplete=</span><span class="s">"off"</span>
                   <span class="na">placeholder=</span><span class="s">"Expiration Year"</span>
                   <span class="na">class=</span><span class="s">"cc-ey"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;label&gt;</span>Security Code (CSC)
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
                   <span class="na">autocomplete=</span><span class="s">"off"</span>
                   <span class="na">placeholder=</span><span class="s">"CSC"</span>
                   <span class="na">class=</span><span class="s">"cc-csc"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn"</span><span class="nt">&gt;</span>
            Tokenize
        <span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/fieldset&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="simple-bank-account-form"></span><span class="bookmark" id="tok-bank-account-form"></span>Simple Bank Account Form<a href="#simple-bank-account-form" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"#"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">id=</span><span class="s">"bank-account-form"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;fieldset&gt;</span>
        <span class="nt">&lt;legend&gt;</span>Bank Account Information<span class="nt">&lt;/legend&gt;</span>
        <span class="nt">&lt;label&gt;</span>Account Holder's Name
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
                   <span class="na">autocomplete=</span><span class="s">"off"</span>
                   <span class="na">placeholder=</span><span class="s">"Bank Account Holder's name"</span>
                   <span class="na">class=</span><span class="s">"ba-name"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;label&gt;</span>Routing Number
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
                   <span class="na">autocomplete=</span><span class="s">"off"</span>
                   <span class="na">placeholder=</span><span class="s">"Routing Number"</span>
                   <span class="na">class=</span><span class="s">"ba-rn"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;label&gt;</span>Account Number
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span>
                   <span class="na">autocomplete=</span><span class="s">"off"</span>
                   <span class="na">placeholder=</span><span class="s">"Account Number"</span>
                   <span class="na">class=</span><span class="s">"ba-an"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;label&gt;</span>Account Type
            <span class="nt">&lt;select&gt;</span>
                <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">''</span> <span class="na">disabled</span> <span class="na">selected</span> <span class="na">style=</span><span class="s">'display:none;'</span><span class="nt">&gt;</span>
                    Select Account Type
                <span class="nt">&lt;/option&gt;</span>
                <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"checking"</span><span class="nt">&gt;</span>CHECKING<span class="nt">&lt;/option&gt;</span>
                <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"savings"</span><span class="nt">&gt;</span>SAVINGS<span class="nt">&lt;/option&gt;</span>
            <span class="nt">&lt;/select&gt;</span>
        <span class="nt">&lt;/label&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">class=</span><span class="s">"btn"</span><span class="nt">&gt;</span>
            Tokenize
        <span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/fieldset&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section">
<h1><span class="bookmark" id="balanced-payouts"></span><span class="bookmark" id="id4"></span>Balanced Payouts<a href="#balanced-payouts" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<p>Balanced Payouts is a stand-alone service for sending money to your seller's
bank account via the ACH network. You can use Balanced Payouts with your
existing processing solution without needing to switch or you may want to
integrate <a href="#id16" class="reference internal"><em>Balanced Processing</em></a>.</p>
<div class="section">
<h2><span class="bookmark" id="tutorial"></span>Tutorial<a href="#tutorial" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>At a high level, we're going to implement the credit-a-merchant endpoint and
here's how we're going to accomplish this:</p>
<ul class="simple">
<li>Securely collecting bank account information with <tt class="docutils literal"><span class="pre">balanced.js</span></tt></li>
<li>Securely submitting that information to Balanced</li>
</ul>
<div class="section">
<h3><span class="bookmark" id="collecting-bank-account-information"></span>Collecting bank account information<a href="#collecting-bank-account-information" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We have a fully implemented <a href="https://gist.github.com/2662770" class="reference external">sample page</a> for you, that you can use to get
started immediately. At any point during this tutorial you feel overwhelmed
or you want help, please use any of the <a href="#support" class="reference internal"><em>support channels</em></a> we
have available.</p>
</div>
<p>Follow the steps for <a href="#tok-including" class="reference internal"><em>including</em></a> and
<a href="#tok-init" class="reference internal"><em>initializing</em></a> <tt class="docutils literal"><span class="pre">balanced.js</span></tt>.</p>
<p>We're going to use the <a href="#tok-bank-account-form" class="reference internal"><em>bank account sample form</em></a>
from the <a href="#tokenization" class="reference internal"><em>Getting Started</em></a> section as it will do very basic information
collection for us.</p>
<p>For convenience, we've rendered the html into a fully functioning form:</p>
<div id="ba-form" class="sphinxcontainer">
<form action="#" id="bank-account-form" method="POST">
    <fieldset>
        <legend>Bank Account Information</legend>
        <label>Account Holder's Name
            <input autocomplete="off" placeholder="Bank Account Holder's name" type="text" class="ba-name">
        </label>
        <label>Routing Number
            <input autocomplete="off" placeholder="Routing Number" type="text" class="ba-rn">
        </label>
        <label>Account Number
            <input autocomplete="off" placeholder="Account Number" type="text" class="ba-an">
        </label>
        <label>Account Type
            <select>
                <option disabled style="display:none;" selected value="">
                    Select Account Type
                </option>
                <option value="checking">CHECKING</option>
                <option value="savings">SAVINGS</option>
            </select>
        </label>
        <button type="submit" class="btn">
            Tokenize
        </button>
    </fieldset>
</form></div>
<p>To collect the information from the form, we're going to enlist the help
of some simple javascript:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// TODO: Replace this with your marketplace URI</span>
<span class="kd">var</span> <span class="nx">marketplaceUri</span> <span class="o">=</span> <span class="s1">'{YOUR-MARKETPLACE-URI}'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#bank-account-form'</span><span class="p">);</span>

<span class="c1">// collect the data from the form.</span>
<span class="kd">var</span> <span class="nx">bankAccountData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">name</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-name'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">account_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-an'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">routing_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.ba-rn'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">type</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'select'</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Now, let's handle the response from Balanced using a simple callback:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">responseCallbackHandler</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">switch</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">case</span> <span class="mi">400</span><span class="o">:</span>
         <span class="c1">// missing or invalid field - check response.error for details</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">404</span><span class="o">:</span>
         <span class="c1">// your marketplace URI is incorrect</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">201</span><span class="o">:</span>
         <span class="c1">// WOO HOO! MONEY!</span>
         <span class="c1">// response.data.uri == URI of the bank account resource you</span>
         <span class="c1">// should store this bank account URI to later credit it</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
         <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'your-marketplace.tld/bank_accounts'</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</div>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p><tt class="docutils literal"><span class="pre">$.post('your-marketplace.tld/bank_accounts',</span> <span class="pre">response.data);</span></tt> is used
as an example above. However, what you should do is iterate through the
<tt class="docutils literal"><span class="pre">response.data</span></tt> object and add hidden form fields to submit alongside
the form. Let us know if you need <a href="#support" class="reference internal"><em>any assistance</em></a>, we're
happy to help.</p>
<p class="last">You can find out more about the <a href="#tok-callback" class="reference internal"><em>callback here</em></a>.</p>
</div>
<p>Now, let's submit it!</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">bankAccount</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">bankAccountData</span><span class="p">,</span> <span class="nx">responseCallbackHandler</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="operating-on-a-stored-bank-account"></span>Operating on a Stored Bank Account<a href="#operating-on-a-stored-bank-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>So you're done tokenizing a bank account? Congratulations! There are several
operations that are now available to you.</p>
<div class="section">
<h4><span class="bookmark" id="issuing-a-credit"></span>Issuing a credit<a href="#issuing-a-credit" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>You can issue a next-day credit/deposit/payout to this stored bank account.</p>
<div class="section">
<h5><span class="bookmark" id="unstoring-a-bank-account"></span>Unstoring a bank account<a href="#unstoring-a-bank-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h5>
<p>Your customers might request their bank account information deleted from your
servers and consequently, ours.</p>
<p>Existing credits to this bank account will still have the bank account's
<tt class="docutils literal"><span class="pre">fingerprint</span></tt> associated with them because we understand that the real world
doesn't cascade and you might want to group these credits again.</p>
<p>However, you and your customers can rest assured that this bank account
has been deleted from our systems.</p>
</div>
</div>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="credit-s-status-field"></span>Credit's Status Field<a href="#credit-s-status-field" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Credits have a <tt class="docutils literal"><span class="pre">status</span></tt> field representing the current status of the credit
through the payout process.</p>
<div class="section">
<h3><span class="bookmark" id="definition"></span>definition<a href="#definition" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-bash"><div class="highlight"><pre>GET /v1/credits/:credit_id
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id5"></span>definition<a href="#id5" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-python"><div class="highlight"><pre><span class="n">balanced</span><span class="o">.</span><span class="n">Credit</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id6"></span>definition<a href="#id6" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-ruby"><div class="highlight"><pre><span class="no">Balanced</span><span class="o">::</span><span class="no">Credit</span><span class="o">.</span><span class="n">find</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id7"></span>definition<a href="#id7" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-php"><div class="highlight"><pre><span class="x">Balanced\Credit::get()</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="request"></span>request<a href="#request" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-bash"><div class="highlight"><pre>curl https://api.balancedpayments.com/v1/credits/CR1HmHcPCOCeHFiaBDBqEsD <span class="se">\</span>
      -u cef27abab42a11e292e3026ba7c1aba6:
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id8"></span>request<a href="#id8" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">balanced</span>

<span class="n">balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s">"cef27abab42a11e292e3026ba7c1aba6"</span><span class="p">)</span>


<span class="n">credit</span> <span class="o">=</span> <span class="n">balanced</span><span class="o">.</span><span class="n">Credit</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'/v1/credits/CR1HmHcPCOCeHFiaBDBqEsD'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id9"></span>request<a href="#id9" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-ruby"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'cef27abab42a11e292e3026ba7c1aba6'</span><span class="p">)</span>

<span class="n">marketplace</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Marketplace</span><span class="o">.</span><span class="n">my_marketplace</span>

<span class="n">credit</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Credit</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'/v1/credits/CR1HmHcPCOCeHFiaBDBqEsD'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id10"></span>request<a href="#id10" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">require</span><span class="p">(</span><span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/vendor/autoload.php'</span><span class="p">);</span>

<span class="nx">Httpful\Bootstrap</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
<span class="nx">RESTful\Bootstrap</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
<span class="nx">Balanced\Bootstrap</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>

<span class="nx">Balanced\Settings</span><span class="o">::</span><span class="nv">$api_key</span> <span class="o">=</span> <span class="s2">"cef27abab42a11e292e3026ba7c1aba6"</span><span class="p">;</span>


<span class="nv">$credit</span> <span class="o">=</span> <span class="nx">Balanced\Credit</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s2">"/v1/credits/CR1HmHcPCOCeHFiaBDBqEsD"</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="response"></span>response<a href="#response" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="response code-block sphinxcontainer">
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"credit"</span><span class="p">,</span> 
    <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{},</span> 
    <span class="s2">"amount"</span><span class="o">:</span> <span class="mi">10000</span><span class="p">,</span> 
    <span class="s2">"appears_on_statement_as"</span><span class="o">:</span> <span class="s2">"example.com"</span><span class="p">,</span> 
    <span class="s2">"bank_account"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"bank_account"</span><span class="p">,</span> 
        <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"verifications_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"verifications"</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">"account_number"</span><span class="o">:</span> <span class="s2">"xxxxxx0001"</span><span class="p">,</span> 
        <span class="s2">"bank_name"</span><span class="o">:</span> <span class="s2">"BANK OF AMERICA, N.A."</span><span class="p">,</span> 
        <span class="s2">"can_debit"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> 
        <span class="s2">"fingerprint"</span><span class="o">:</span> <span class="s2">"1eH719hwbYRpEILVKyboPs_pn"</span><span class="p">,</span> 
        <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
        <span class="s2">"name"</span><span class="o">:</span> <span class="s2">"Johann Bernoulli"</span><span class="p">,</span> 
        <span class="s2">"routing_number"</span><span class="o">:</span> <span class="s2">"121000358"</span><span class="p">,</span> 
        <span class="s2">"type"</span><span class="o">:</span> <span class="s2">"checking"</span><span class="p">,</span> 
        <span class="s2">"verification_uri"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
        <span class="s2">"verifications_uri"</span><span class="o">:</span> <span class="s2">"/v1/bank_accounts/BA1shyoaNJdsi2Fhz4GfSvJ/verifications"</span>
    <span class="p">},</span> 
    <span class="s2">"created_at"</span><span class="o">:</span> <span class="s2">"2013-05-03T19:52:36.623982Z"</span><span class="p">,</span> 
    <span class="s2">"description"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"CR1HmHcPCOCeHFiaBDBqEsD"</span><span class="p">,</span> 
    <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"pending"</span><span class="p">,</span> 
    <span class="s2">"uri"</span><span class="o">:</span> <span class="s2">"/v1/credits/CR1HmHcPCOCeHFiaBDBqEsD"</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>There are three possible values for the <tt class="docutils literal"><span class="pre">status</span></tt> field on a credit:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">pending</span></tt></dt>
<dd>As soon as the credit is created through the API, the status shows
as <tt class="docutils literal"><span class="pre">pending</span></tt>. This indicates that Balanced received the information for the
credit and will begin processing. The ACH network itself processes transactions
in a batch format. Batch submissions are processed at 3pm PST on business days.
If the credit is created after 3pm PST, it will not be submitted for processing
until 3pm PST the next business day.</dd>
<dt><tt class="docutils literal"><span class="pre">paid</span></tt></dt>
<dd>One business day after the batch submission, the status will change to
<tt class="docutils literal"><span class="pre">paid</span></tt>. That is the _expected_ status of the credit. If the account number and
routing number were entered correctly, the money should in fact be available to
the seller. However, there is no immediate confirmation regarding the
transaction showing up in the seller's account successfully</dd>
<dt><tt class="docutils literal"><span class="pre">failed</span></tt></dt>
<dd>The seller's bank has up to three business days from when the money
_should_ be available to indicate a rejection along with the rejection reason.
Unfortunately, not all banks comply with ACH network policies and may respond
after three business days with a rejection. As soon as Balanced receives the
rejection, the status is updated to <tt class="docutils literal"><span class="pre">failed</span></tt></dd>
</dl>
</div>
<div class="section">
<h2><span class="bookmark" id="payout-methods"></span>Payout Methods<a href="#payout-methods" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Currently Balanced only supports payouts to bank accounts via ACH but we will
add more. All of this is publicly tracked via github issues. For example:</p>
<ul class="simple">
<li><a href="https://github.com/balanced/balanced-api/issues/69" class="reference external">Payouts via Check</a></li>
<li><a href="https://github.com/balanced/balanced-api/issues/32" class="reference external">Pushing to Cards</a></li>
</ul>
<p>Comment on those that would be useful to you or create issues for ones you'd
like to see supported!</p>
</div>
<div class="section">
<h2><span class="bookmark" id="canceling-credits"></span>Canceling Credits<a href="#canceling-credits" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Canceling a credit is currently under active development and discussion on
<a href="https://github.com/balanced/balanced-api/issues/151" class="reference external">github issue #151</a> - it's not very straightforward due to the asynchronous
nature of ACH.</p>
<p>If you require immediately canceling of a credit, please contact us via any
of our <a href="#support" class="reference internal"><em>support channels</em></a> and we will attempt to cancel the
credit.</p>
<p>When referencing a specific credit, please provide the credit's <tt class="docutils literal"><span class="pre">uri</span></tt> so that
we may quickly proceed with fulfilling your request.</p>
</div>
<div class="section">
<h2><span class="bookmark" id="pre-funding-your-account"></span>Pre-funding Your Account<a href="#pre-funding-your-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Any payout issued requires maintaining sufficient money in your Balanced account.</p>
<p>If you do not have a sufficient balance, Balanced will return a <tt class="docutils literal"><span class="pre">409</span></tt> http
status code, stating that you do not have sufficient funds to cover your
desired ACH operation.</p>
<p>As a result, you will have to add funds from your bank account to your account
via the Balanced <a href="https://www.balancedpayments.com/dashboard" class="reference external">dashboard</a>.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">We advise that you transfer a large amount in you Balanced account or you
may request that Balanced always keep a constant amount in your account for
you. We're publically tracking this on <a href="https://github.com/balanced/balanced-api/issues/132" class="reference external">github issue #132</a> and appreciate your input</p>
</div>
<p>Transfers may take 2-5 days for the funds to become available; alternatively, you
may fund your account <strong>instantly</strong> with <a href="#id16" class="reference internal"><em>Balanced Processing!</em></a></p>
</div>
<div class="section">
<h2><span class="bookmark" id="testing"></span>Testing<a href="#testing" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Balanced provides various utilities to aid you in testing your <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a>
integration.</p>
<p>When integrating payouts, it's worth noting that incorrect bank routing numbers
are a very commonly encountered error as Balanced does real-time checks against
the <a href="https://www.fededirectory.frb.org" class="reference external">FedACH directory</a>.</p>
<p>To aid you while integrating, Balanced provides special routing and
account numbers that can simulate various scenarios that can go wrong.</p>
<div class="section">
<h3><span class="bookmark" id="test-bank-account-numbers"></span>Test Bank Account Numbers<a href="#test-bank-account-numbers" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="20%">
<col width="27%">
<col width="53%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Routing Number</th>
<th class="head">Account Number</th>
<th class="head">Scenario</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">100000007</span></tt></td>
<td><tt class="docutils literal"><span class="pre">8887776665555</span></tt></td>
<td>Invalid Routing Number</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">111111118</span></tt></td>
<td><tt class="docutils literal"><span class="pre">8887776665555</span></tt></td>
<td>Invalid Routing Number</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">021000021</span></tt></td>
<td><tt class="docutils literal"><span class="pre">9900000000</span></tt></td>
<td>Transitions credit state to <tt class="docutils literal"><span class="pre">pending</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">321174851</span></tt></td>
<td><tt class="docutils literal"><span class="pre">9900000001</span></tt></td>
<td>Transitions credit state to <tt class="docutils literal"><span class="pre">pending</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">021000021</span></tt></td>
<td><tt class="docutils literal"><span class="pre">9900000002</span></tt></td>
<td>Transitions credit state to <tt class="docutils literal"><span class="pre">paid</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">321174851</span></tt></td>
<td><tt class="docutils literal"><span class="pre">9900000003</span></tt></td>
<td>Transitions credit state to <tt class="docutils literal"><span class="pre">paid</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">021000021</span></tt></td>
<td><tt class="docutils literal"><span class="pre">9900000004</span></tt></td>
<td>Transitions credit state to <tt class="docutils literal"><span class="pre">failed</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">321174851</span></tt></td>
<td><tt class="docutils literal"><span class="pre">9900000005</span></tt></td>
<td>Transitions credit state to <tt class="docutils literal"><span class="pre">failed</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<h3><span class="bookmark" id="examples"></span>Examples<a href="#examples" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="section">
<h4><span class="bookmark" id="simulating-erroneous-routing-numbers"></span>simulating erroneous routing numbers<a href="#simulating-erroneous-routing-numbers" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<div class="section">
<h5><span class="bookmark" id="simulating-pending-status"></span>simulating pending status<a href="#simulating-pending-status" class="headerlink" title="Permalink to this headline">&#8757;</a></h5>
<div class="section">
<h6><span class="bookmark" id="simulating-paid-status"></span>simulating paid status<a href="#simulating-paid-status" class="headerlink" title="Permalink to this headline">&#8757;</a></h6>
<div class="section">
<h7><span class="bookmark" id="simulating-failed-status"></span>simulating failed status<a href="#simulating-failed-status" class="headerlink" title="Permalink to this headline">&#8757;</a></h7>
</div>
</div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="request-logs"></span>Request Logs<a href="#request-logs" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>As you integrate and test <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a>, you may find it useful to view
all your sanitized API request logs. They are viewable via the logs section
in the <a href="https://www.balancedpayments.com/dashboard" class="reference external">dashboard</a></p>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="submission-delivery-times"></span><span class="bookmark" id="payouts-cutoff"></span>Submission &amp; Delivery times<a href="#submission-delivery-times" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>The cutoff for submitting payouts is <strong>3:00 PM Pacific (PT)</strong> time. Payouts will <em>not</em> be
delivered on weekends or <a href="&lt;http://www.federalreserve.gov/aboutthefed/k8.htm&gt;" class="reference external">bank holidays</a>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="13%">
<col width="12%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">holiday</th>
<th class="head">2012</th>
<th class="head">2013</th>
<th class="head">2014</th>
<th class="head">2015</th>
<th class="head">2016</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>New Year's Day</td>
<td>January 2</td>
<td>January 1</td>
<td>January 1</td>
<td>January 1</td>
<td>January 1</td>
</tr>
<tr class="row-odd"><td>Birthday of Martin Luther King, Jr.</td>
<td>January 16</td>
<td>January 21</td>
<td>January 20</td>
<td>January 19</td>
<td>January 18</td>
</tr>
<tr class="row-even"><td>Washington's Birthday</td>
<td>February 20</td>
<td>February 18</td>
<td>February 17</td>
<td>February 16</td>
<td>February 15</td>
</tr>
<tr class="row-odd"><td>Memorial Day</td>
<td>May 28</td>
<td>May 27</td>
<td>May 26</td>
<td>May 25</td>
<td>May 30</td>
</tr>
<tr class="row-even"><td>Independence Day</td>
<td>July 4</td>
<td>July 4</td>
<td>July 4</td>
<td>July 4 <a href="#id12" id="id11" class="footnote-reference">[*]</a></td>
<td>July 4</td>
</tr>
<tr class="row-odd"><td>Labor Day</td>
<td>September 3</td>
<td>September 2</td>
<td>September 1</td>
<td>September 7</td>
<td>September 5</td>
</tr>
<tr class="row-even"><td>Columbus Day</td>
<td>October 8</td>
<td>October 14</td>
<td>October 13</td>
<td>October 12</td>
<td>October 10</td>
</tr>
<tr class="row-odd"><td>Veterans Day</td>
<td>November 12</td>
<td>November 11</td>
<td>November 11</td>
<td>November 11</td>
<td>November 11</td>
</tr>
<tr class="row-even"><td>Thanksgiving Day</td>
<td>November 22</td>
<td>November 28</td>
<td>November 27</td>
<td>November 26</td>
<td>November 24</td>
</tr>
<tr class="row-odd"><td>Christmas Day</td>
<td>December 25</td>
<td>December 25</td>
<td>December 25</td>
<td>December 25</td>
<td>December 26</td>
</tr>
</tbody>
</table>
<table rules="none" frame="void" id="id12" class="docutils footnote">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a href="#id11" class="fn-backref">[*]</a></td><td>Saturday</td></tr>
</tbody>
</table>
<p>Here's some common scenarios for payouts. Remember, the next-day cut off is
at <strong>3:00 PM Pacific (PT)</strong>.</p>
<table border="1" class="docutils">
<caption>Common Payout Scenarios</caption>
<colgroup>
<col width="27%">
<col width="47%">
<col width="27%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type of Scenario</th>
<th class="head">Example Submission Date</th>
<th class="head">Available When? <a href="#id14" id="id13" class="footnote-reference">[&#8224;]</a></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Most common</td>
<td>Tuesday @ 1:45PM PT</td>
<td>Wednesday @ 9:00AM PT</td>
</tr>
<tr class="row-odd"><td><a href="&lt;http://www.federalreserve.gov/aboutthefed/k8.htm&gt;" class="reference external">Bank holidays</a></td>
<td>July 3rd @ 1:30PM PT</td>
<td>July 5th @ 9:00AM PT</td>
</tr>
<tr class="row-even"><td>Late submission</td>
<td>Friday @ 3:30PM PT</td>
<td>Tuesday @ 3:30PM PT</td>
</tr>
</tbody>
</table>
<table rules="none" frame="void" id="id14" class="docutils footnote">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a href="#id13" class="fn-backref">[&#8224;]</a></td><td>Assumes that day is a working business day -- does not fall on a
weekend or a <a href="bankholidays" class="reference external">federal reserve holiday</a>.</td></tr>
</tbody>
</table>
</div>
<div class="section">
<h2><span class="bookmark" id="best-practices"></span><span class="bookmark" id="payouts-best-practices"></span>Best Practices<a href="#best-practices" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Automated Clearing House transactions are asynchronous, requiring upfront effort
in educating your consumers and setting the appropriate expectations to deliver
a great product.</p>
<p>There are a few simple best practices that can dramatically increase user
convenience, allowing for a much more enjoyable experience and minimizing
problematic encounters.</p>
<div class="section">
<h3><span class="bookmark" id="sending-a-payout-for-the-first-time"></span>Sending a payout for the first time<a href="#sending-a-payout-for-the-first-time" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>There&#8217;s a very small chance the first payout to a customer can fail. This is
usually due to the customer accidentally providing an incorrect bank account
number.</p>
<p>Balanced validates bank routing numbers in real-time using the
<a href="https://www.fededirectory.frb.org" class="reference external">FedACH directory</a>, but since bank accounts are not standardized, incorrect
bank account numbers are not caught until the payout fails and Balanced
is notified (3) three to (5) five business days after submission!</p>
<p>Our statistics show that most of the time, your users will provide the correct
bank routing and account numbers with the help of a properly designed and robust
form. Their payout will appear the next business day, as expected. Once a
successful payout has been made, future credits to that bank account
will continue to take one business day when issued before the
<a href="#payouts-cutoff" class="reference internal"><em>next-day cut-offs</em></a>.</p>
<p>However, if a payout fails, we&#8217;ll notify you via email and the dashboard. We're
working on implementing web hooks, you can follow our progress on
<a href="https://github.com/balanced/balanced-api/issues/70" class="reference external">github issue #70</a>. Go ahead and add your +1 in the comments section to
receive updates on our progress.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="help-your-users-avoid-mistakes"></span>Help your users avoid mistakes<a href="#help-your-users-avoid-mistakes" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Due to the nature of the ACH network, failure notifications can be delayed
for up to (4) four business days! This can be extremely inconvenient and
frustrating to your users and your business, since some merchants rely on
speedy ACH payments for operating capital.</p>
<p>For example, an account number typo can, on average, cause payment delays by
up to (3) three to (5) five business days!</p>
<p>Our recommendation, for mitigating these user experience issues, is to properly
invest time in building a robust and reliable form to acquire merchant
bank account information properly.</p>
<p>Here are some tips:</p>
<ol class="arabic">
<li><p class="first">Display a check image to illustrate which number is the routing number vs.
account number.</p>
<p>We've conveniently provided one - however, you may choose to design your
own:</p>
<div class="figure">
<img src="https://s3.amazonaws.com/justice.web/docs/check_image.png" alt="https://s3.amazonaws.com/justice.web/docs/check_image.png">
</div>
</li>
<li><p class="first">US routing numbers are 9 digits and are usually located in the lower left
corner of most checks. Common aliases to <strong>routing number</strong>:</p>
<ul class="simple">
<li>RTN (Routing Transit Number)</li>
<li>ABA</li>
<li><a href="http://en.wikipedia.org/wiki/Bank_code" class="reference external">Bank code</a></li>
</ul>
</li>
<li><p class="first">Routing numbers are used to set up direct deposit transfers. You can use this
as an aid to your customers who are inquiring whether or not they have the
right routing number.</p>
</li>
<li><p class="first">Balanced has provided very useful routing number validators in our
<a href="#tok-validators-banks" class="reference internal"><em>balanced.js</em></a> library.
Be sure to use these helper functions to build a robust form.</p>
</li>
<li><p class="first">Set your customer's expectation that payments might be delayed by up to
(3) three to (5) five business days if incorrect information is provided.</p>
</li>
<li><p class="first">Highlight to your customers that <em>wire transfer numbers</em> are <strong>NOT</strong> the same
as the routing number, and they are <strong>NOT</strong> the same as the bank account
number. Be sure to clarify this when asking your users for their information.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="section">
<h1><span class="bookmark" id="balanced-processing"></span><span class="bookmark" id="id16"></span>Balanced Processing<a href="#balanced-processing" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<p>Balanced Processing provides a complete solution for accepting credit
card payments in a simple, secure manner, relieving you from the hassles of PCI
compliance.</p>
<div class="section">
<h2><span class="bookmark" id="id17"></span>Tutorial<a href="#id17" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>At a high level, we're going to implement the process for creating a charge.
Here's how we're going to accomplish this:</p>
<ul class="simple">
<li>Securely collecting credit card information with <tt class="docutils literal"><span class="pre">balanced.js</span></tt></li>
<li>Securely submitting that information to Balanced</li>
<li>Creating an account and charging your buyer</li>
</ul>
<div class="section">
<h3><span class="bookmark" id="collecting-credit-card-information"></span>Collecting credit card information<a href="#collecting-credit-card-information" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We have a fully implemented <a href="https://gist.github.com/2662770" class="reference external">sample page</a> for you, that you can use to get
started immediately. At any point during this tutorial you feel overwhelmed
or you want help, please use any of the <a href="#support" class="reference internal"><em>support channels</em></a> we
have available.</p>
</div>
<p>Follow the steps for <a href="#tok-including" class="reference internal"><em>including</em></a> and
<a href="#tok-init" class="reference internal"><em>initializing</em></a> <tt class="docutils literal"><span class="pre">balanced.js</span></tt>.</p>
<p>We're going to use the <a href="#tok-card-form" class="reference internal"><em>card sample form</em></a>
from the <a href="#tokenization" class="reference internal"><em>Getting Started</em></a> section as it will do very basic information
collection for us.</p>
<p>For convenience, we've rendered the html into a fully functioning form:</p>
<div id="cc-form" class="sphinxcontainer">
<form action="#" id="credit-card-form" method="POST">
    <fieldset>
        <legend>Credit Card Details</legend>
        <label>Card Number
            <input autocomplete="off" placeholder="Card Number" type="text" class="cc-number">
        </label>
        <label>Expiration
            <input autocomplete="off" placeholder="Expiration Month" type="text" class="cc-em">
            <span>/</span>
            <input autocomplete="off" placeholder="Expiration Year" type="text" class="cc-ey">
        </label>
        <label>Security Code (CSC)
            <input autocomplete="off" placeholder="CSC" type="text" class="cc-csc">
        </label>
        <button type="submit" class="btn">
            Tokenize
        </button>
    </fieldset>
</form></div>
<p>To collect the information from the form, we're going to enlist the help
of some simple javascript:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// TODO: Replace this with your marketplace URI</span>
<span class="kd">var</span> <span class="nx">marketplaceUri</span> <span class="o">=</span> <span class="s1">'{YOUR-MARKETPLACE-URI}'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">$form</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'#credit-card-form'</span><span class="p">);</span>

<span class="c1">// collect the data from the form.</span>
<span class="kd">var</span> <span class="nx">creditCardData</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">card_number</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-number'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">expiration_month</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-em'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">expiration_year</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'.cc-ey'</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
    <span class="nx">security_code</span><span class="o">:</span> <span class="nx">$form</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s1">'cc-csc'</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Now, let's handle the response from Balanced using a simple callback:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">responseCallbackHandler</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">switch</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">case</span> <span class="mi">400</span><span class="o">:</span>
         <span class="c1">// missing or invalid field - check response.error for details</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">404</span><span class="o">:</span>
         <span class="c1">// your marketplace URI is incorrect</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
         <span class="k">break</span><span class="p">;</span>
     <span class="k">case</span> <span class="mi">201</span><span class="o">:</span>
         <span class="c1">// WOO HOO! MONEY!</span>
         <span class="c1">// response.data.uri == URI of the card resource</span>
         <span class="c1">// you should store this returned card URI to later charge it</span>
         <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
         <span class="nx">$</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">'your-marketplace.tld/cards'</span><span class="p">,</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</div>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p><tt class="docutils literal"><span class="pre">$.post('your-marketplace.tld/cards',</span> <span class="pre">response.data);</span></tt> is used
as an example above. However, what you should do is iterate through the
<tt class="docutils literal"><span class="pre">response.data</span></tt> object and add hidden form fields to submit alongside
the form. Let us know if you need <a href="#support" class="reference internal"><em>any assistance</em></a>, we're
happy to help.</p>
<p class="last">You can find out more about the <a href="#tok-callback" class="reference internal"><em>callback here</em></a>.</p>
</div>
<p>Now, let's submit it!</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">balanced</span><span class="p">.</span><span class="nx">card</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">bankAccountData</span><span class="p">,</span> <span class="nx">responseCallbackHandler</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="operating-with-a-card-token"></span>Operating with a Card Token<a href="#operating-with-a-card-token" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>So you're done tokenizing card data? Congratulations! However, before you
do any operations on a card, you must associate the card to an account. That
means that if you just want to charge a card, you must create an account,
associate the card with that account, and then issue a debit.</p>
<div class="section">
<h4><span class="bookmark" id="creating-an-account"></span><span class="bookmark" id="processing-buyer-acct-with-tok"></span>Creating an account<a href="#creating-an-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>Ok, so you've got the card token, referred to as the <tt class="docutils literal"><span class="pre">uri</span></tt> of the returned Card
resource.</p>
<p>Let's create an account to associate the card token with:</p>
<dl class="docutils">
<dt>As always, anytime you create a resource on Balanced, you should</dt>
<dd><a href="#uri-vs-id" class="reference internal"><em>store the uri</em></a> in your database.</dd>
</dl>
<div class="section">
<h5><span class="bookmark" id="associating-a-card-to-an-existing-account"></span><span class="bookmark" id="processing-buyer-add-tok-to-acct"></span>Associating a card to an existing account<a href="#associating-a-card-to-an-existing-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h5>
<p>A very common operation is associating a new card with an existing account.
Let's show how this is done:</p>
<p>This will add the card to the account specified by the account URI, <strong>and make
it the primary funding source for any future holds and debits</strong>.</p>
<div class="section">
<h6><span class="bookmark" id="charging-a-card"></span>Charging a Card<a href="#charging-a-card" class="headerlink" title="Permalink to this headline">&#8757;</a></h6>
<p>Once you've either <a href="#processing-buyer-acct-with-tok" class="reference internal"><em>added a a card to an account</em></a>
or <a href="#processing-buyer-add-tok-to-acct" class="reference internal"><em>associated a card to an existing account</em></a>,
you can now easily charge the card -- or to be exact, debiting an account:</p>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Balanced does NOT take its fees from your charges, instead it instruments
all operations that have occurred on the API and later invoices you. Read
<a href="#overview-fees-balanced" class="reference internal"><em>more about fees</em></a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="refunds"></span>Refunds<a href="#refunds" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>You can refund a debit up to its original amount, so that means you can partially
refund a debit as well.</p>
<p>In order for a refund to go through successfully, you <em>must</em> have enough money
in <a href="#mp-escrow" class="reference internal"><em>implicit escrow</em></a> to cover your refund.</p>
<p>Here are some scenarios:</p>
<div class="section">
<h3><span class="bookmark" id="full-refund"></span>Full Refund<a href="#full-refund" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Let's say you've debited an account for $20.00</p>
<ul class="simple">
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance says $20.00</li>
<li>You issue a refund for $20.00</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance says $0.00</li>
</ul>
</div>
<div class="section">
<h3><span class="bookmark" id="partial-refund"></span>Partial Refund<a href="#partial-refund" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>You can also perform multiple partial refunds up to the original amount.</p>
<p>Let's say you've debited an account for $20.00</p>
<ul class="simple">
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance says $20.00</li>
<li>You issue a refund for $10.00</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance says $10.00</li>
<li>You issue another refund for $5.00</li>
<li>Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance says $5.00</li>
</ul>
</div>
<div class="section">
<h3><span class="bookmark" id="not-enough-funds-to-refund"></span>Not Enough Funds to Refund<a href="#not-enough-funds-to-refund" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Let's say you've debited an account for $20.00</p>
<ul>
<li><p class="first">Your <tt class="docutils literal"><span class="pre">in_escrow</span></tt> balance says $20.00</p>
</li>
<li><p class="first">You issue a refund for $30.00</p>
</li>
<li><p class="first">The API will return a <strong>400</strong> status code, similar to:</p>
<div class="highlight-bash"><div class="highlight"><pre>Bad Request: 400: Invalid field <span class="o">[</span>amount<span class="o">]</span> - <span class="s2">"3000"</span> must be &lt;<span class="o">=</span> 2000
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="holds"></span>Holds<a href="#holds" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Balanced supports the concepts of <em class="xref std std-term">holds</em>. Holds are a type of
authorization that reserves (i.e. holds) a dollar amount on the customer's
credit card for the merchant to process later, usually within 7 days. If the
transaction is not processed (known as post-authorization) by the end of the
hold period, the amount is added back to the available credit on the
cardholder's credit card. <strong>The customer is not billed.</strong></p>
<p>Holds are common in the industries where the amount of the goods or services
are "reserved" on the cardholder's credit card.</p>
<p>If you issue a debit on an account, Balanced uses holds behinds the scenes
but captures the funds immediately -- you will always see a hold returned on a
debit. For example:</p>
<div class="section">
<h3><span class="bookmark" id="id18"></span>definition<a href="#id18" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-bash"><div class="highlight"><pre>POST https://api.balancedpayments.com/v1/marketplaces/:marketplace_id/debits
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id19"></span>definition<a href="#id19" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-python"><div class="highlight"><pre><span class="n">balanced</span><span class="o">.</span><span class="n">Account</span><span class="o">.</span><span class="n">debit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id20"></span>definition<a href="#id20" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-ruby"><div class="highlight"><pre><span class="no">Balanced</span><span class="o">::</span><span class="no">Account</span><span class="o">.</span><span class="n">debit</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id21"></span>definition<a href="#id21" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="definition code-block sphinxcontainer">
<div class="highlight-php"><div class="highlight"><pre><span class="x">\Balanced\Account-&gt;debit();</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id22"></span>request<a href="#id22" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-bash"><div class="highlight"><pre>curl https://api.balancedpayments.com/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/debits <span class="se">\</span>
     -u cef27abab42a11e292e3026ba7c1aba6: <span class="se">\</span>

     -d <span class="s2">"amount=1000"</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id23"></span>request<a href="#id23" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">balanced</span>

<span class="n">balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s">"cef27abab42a11e292e3026ba7c1aba6"</span><span class="p">)</span>


<span class="n">account</span> <span class="o">=</span> <span class="n">balanced</span><span class="o">.</span><span class="n">Account</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">'/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN'</span><span class="p">)</span>
<span class="n">account</span><span class="o">.</span><span class="n">debit</span><span class="p">(</span><span class="n">amount</span><span class="o">=</span><span class="s">'1000'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id24"></span>request<a href="#id24" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-ruby"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'balanced'</span>
<span class="no">Balanced</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s1">'cef27abab42a11e292e3026ba7c1aba6'</span><span class="p">)</span>

<span class="n">account</span> <span class="o">=</span> <span class="no">Balanced</span><span class="o">::</span><span class="no">Account</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN"</span><span class="p">)</span>
<span class="n">account</span><span class="o">.</span><span class="n">debit</span><span class="p">(</span><span class="ss">:amount</span> <span class="o">=&gt;</span> <span class="s1">'1000'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id25"></span>request<a href="#id25" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="request code-block sphinxcontainer">
<div class="highlight-php"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">require</span><span class="p">(</span><span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/vendor/autoload.php'</span><span class="p">);</span>

<span class="nx">Httpful\Bootstrap</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
<span class="nx">RESTful\Bootstrap</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>
<span class="nx">Balanced\Bootstrap</span><span class="o">::</span><span class="na">init</span><span class="p">();</span>

<span class="nx">Balanced\Settings</span><span class="o">::</span><span class="nv">$api_key</span> <span class="o">=</span> <span class="s2">"cef27abab42a11e292e3026ba7c1aba6"</span><span class="p">;</span>


<span class="nv">$account</span> <span class="o">=</span> <span class="nx">\Balanced\Account</span><span class="o">::</span><span class="na">get</span><span class="p">(</span><span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN"</span><span class="p">);</span>
<span class="nv">$account</span><span class="o">-&gt;</span><span class="na">debit</span><span class="p">(</span><span class="s1">'1000'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="id26"></span>response<a href="#id26" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<div class="response code-block sphinxcontainer">
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"debit"</span><span class="p">,</span> 
    <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"refunds_uri"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
            <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"refunds"</span>
        <span class="p">}</span>
    <span class="p">},</span> 
    <span class="s2">"account"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"account"</span><span class="p">,</span> 
        <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"bank_accounts_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"bank_accounts"</span>
            <span class="p">},</span> 
            <span class="s2">"cards_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"cards"</span>
            <span class="p">},</span> 
            <span class="s2">"credits_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"credits"</span>
            <span class="p">},</span> 
            <span class="s2">"debits_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"debits"</span>
            <span class="p">},</span> 
            <span class="s2">"holds_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"holds"</span>
            <span class="p">},</span> 
            <span class="s2">"refunds_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"refunds"</span>
            <span class="p">},</span> 
            <span class="s2">"transactions_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"page"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"transactions"</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">"bank_accounts_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/bank_accounts"</span><span class="p">,</span> 
        <span class="s2">"cards_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/cards"</span><span class="p">,</span> 
        <span class="s2">"created_at"</span><span class="o">:</span> <span class="s2">"2013-05-03T19:53:53.574179Z"</span><span class="p">,</span> 
        <span class="s2">"credits_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/credits"</span><span class="p">,</span> 
        <span class="s2">"debits_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/debits"</span><span class="p">,</span> 
        <span class="s2">"email_address"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
        <span class="s2">"holds_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/holds"</span><span class="p">,</span> 
        <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"AC1qfkt7SK2ralNUvmexKedN"</span><span class="p">,</span> 
        <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
        <span class="s2">"name"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
        <span class="s2">"refunds_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/refunds"</span><span class="p">,</span> 
        <span class="s2">"roles"</span><span class="o">:</span> <span class="p">[</span>
            <span class="s2">"buyer"</span>
        <span class="p">],</span> 
        <span class="s2">"transactions_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/transactions"</span><span class="p">,</span> 
        <span class="s2">"uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN"</span>
    <span class="p">},</span> 
    <span class="s2">"amount"</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span> 
    <span class="s2">"appears_on_statement_as"</span><span class="o">:</span> <span class="s2">"example.com"</span><span class="p">,</span> 
    <span class="s2">"available_at"</span><span class="o">:</span> <span class="s2">"2013-05-03T19:54:03.709702Z"</span><span class="p">,</span> 
    <span class="s2">"created_at"</span><span class="o">:</span> <span class="s2">"2013-05-03T19:54:03.916264Z"</span><span class="p">,</span> 
    <span class="s2">"description"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
    <span class="s2">"fee"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
    <span class="s2">"hold"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"hold"</span><span class="p">,</span> 
        <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"debit_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"debit"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"debit"</span>
            <span class="p">},</span> 
            <span class="s2">"source_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"card"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"source"</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">"account_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN"</span><span class="p">,</span> 
        <span class="s2">"amount"</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span> 
        <span class="s2">"created_at"</span><span class="o">:</span> <span class="s2">"2013-05-03T19:54:03.936674Z"</span><span class="p">,</span> 
        <span class="s2">"debit_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/debits/WD1BS2iIqHElXZYNkDMwcxw2"</span><span class="p">,</span> 
        <span class="s2">"description"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
        <span class="s2">"expires_at"</span><span class="o">:</span> <span class="s2">"2013-05-10T19:54:03.368407Z"</span><span class="p">,</span> 
        <span class="s2">"fee"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
        <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"HL1BTtDegDEQyQd2vpuu6c3c"</span><span class="p">,</span> 
        <span class="s2">"is_void"</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span> 
        <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
        <span class="s2">"source_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/cards/CC1p7212WW2sLmTYbyd0lxaE"</span><span class="p">,</span> 
        <span class="s2">"transaction_number"</span><span class="o">:</span> <span class="s2">"HL712-646-1005"</span><span class="p">,</span> 
        <span class="s2">"uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/holds/HL1BTtDegDEQyQd2vpuu6c3c"</span>
    <span class="p">},</span> 
    <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"WD1BS2iIqHElXZYNkDMwcxw2"</span><span class="p">,</span> 
    <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
    <span class="s2">"on_behalf_of"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
    <span class="s2">"refunds_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/debits/WD1BS2iIqHElXZYNkDMwcxw2/refunds"</span><span class="p">,</span> 
    <span class="s2">"source"</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"card"</span><span class="p">,</span> 
        <span class="s2">"_uris"</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">"account_uri"</span><span class="o">:</span> <span class="p">{</span>
                <span class="s2">"_type"</span><span class="o">:</span> <span class="s2">"account"</span><span class="p">,</span> 
                <span class="s2">"key"</span><span class="o">:</span> <span class="s2">"account"</span>
            <span class="p">}</span>
        <span class="p">},</span> 
        <span class="s2">"account_uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN"</span><span class="p">,</span> 
        <span class="s2">"brand"</span><span class="o">:</span> <span class="s2">"MasterCard"</span><span class="p">,</span> 
        <span class="s2">"card_type"</span><span class="o">:</span> <span class="s2">"mastercard"</span><span class="p">,</span> 
        <span class="s2">"created_at"</span><span class="o">:</span> <span class="s2">"2013-05-03T19:53:52.565245Z"</span><span class="p">,</span> 
        <span class="s2">"expiration_month"</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span> 
        <span class="s2">"expiration_year"</span><span class="o">:</span> <span class="mi">2020</span><span class="p">,</span> 
        <span class="s2">"hash"</span><span class="o">:</span> <span class="s2">"b7250dd4b4827a88d5e4132b67f02916bce6f8e83d4ca0d779d1351b360ff6af"</span><span class="p">,</span> 
        <span class="s2">"id"</span><span class="o">:</span> <span class="s2">"CC1p7212WW2sLmTYbyd0lxaE"</span><span class="p">,</span> 
        <span class="s2">"is_valid"</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> 
        <span class="s2">"last_four"</span><span class="o">:</span> <span class="s2">"5100"</span><span class="p">,</span> 
        <span class="s2">"meta"</span><span class="o">:</span> <span class="p">{},</span> 
        <span class="s2">"name"</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span> 
        <span class="s2">"postal_code_check"</span><span class="o">:</span> <span class="s2">"true"</span><span class="p">,</span> 
        <span class="s2">"security_code_check"</span><span class="o">:</span> <span class="s2">"true"</span><span class="p">,</span> 
        <span class="s2">"uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/accounts/AC1qfkt7SK2ralNUvmexKedN/cards/CC1p7212WW2sLmTYbyd0lxaE"</span>
    <span class="p">},</span> 
    <span class="s2">"status"</span><span class="o">:</span> <span class="s2">"succeeded"</span><span class="p">,</span> 
    <span class="s2">"transaction_number"</span><span class="o">:</span> <span class="s2">"W671-450-8141"</span><span class="p">,</span> 
    <span class="s2">"uri"</span><span class="o">:</span> <span class="s2">"/v1/marketplaces/TEST-MP6iIiWUKlGzrCHsJvy1JzxZ/debits/WD1BS2iIqHElXZYNkDMwcxw2"</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="alert admonition warning">
<p class="first admonition-title">Warning</p>
<p>For all intents and purposes, Balanced does not recommend holds and considers
their usage as a very advanced feature as they cause much confusion and are
cumbersome to manage.</p>
<p class="last">If your project requires holds and you need help, please reach out
to us using our <a href="#support" class="reference internal"><em>support channels</em></a>.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="creating-a-hold"></span>Creating a hold<a href="#creating-a-hold" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>A hold is created in a way similar to creating a debit. Creating a hold will
return a URI which can be used to perform a capture later, up to the full
amount of the hold.</p>
</div>
<div class="section">
<h3><span class="bookmark" id="capturing-a-hold"></span>Capturing a hold<a href="#capturing-a-hold" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Here's an example on how to capture a hold:</p>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="processing-testing"></span><span class="bookmark" id="id27"></span>Testing<a href="#processing-testing" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<div class="section">
<h3><span class="bookmark" id="test-credit-card-numbers"></span>Test credit card numbers<a href="#test-credit-card-numbers" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>These cards will be accepted in our system only for a <strong>TEST</strong> marketplace.</p>
<table border="1" class="table table-hover docutils">
<colgroup>
<col width="17%">
<col width="28%">
<col width="19%">
<col width="36%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Card Brand</th>
<th class="head">Number</th>
<th class="head">Security Code</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>VISA</td>
<td>4111111111111111</td>
<td>123</td>
<td>SUCCESS</td>
</tr>
<tr class="row-odd"><td>MasterCard</td>
<td>5105105105105100</td>
<td>123</td>
<td>SUCCESS</td>
</tr>
<tr class="row-even"><td>AMEX</td>
<td>341111111111111</td>
<td>1234</td>
<td>SUCCESS</td>
</tr>
<tr class="row-odd"><td>VISA</td>
<td>4444444444444448 <a href="#id30" id="id28" class="footnote-reference">[2]</a></td>
<td>123</td>
<td>SIMULATE PROCESSOR FAILURE</td>
</tr>
<tr class="row-even"><td>VISA</td>
<td>4222222222222220 <a href="#id31" id="id29" class="footnote-reference">[3]</a></td>
<td>123</td>
<td>SIMULATE TOKENIZATION ERROR</td>
</tr>
</tbody>
</table>
<table rules="none" frame="void" id="id30" class="docutils footnote">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a href="#id28" class="fn-backref">[2]</a></td><td>Simulate a card which can be tokenized but will not be accepted for creating
holds or debits. This type of failure is what you would expect if you try to
create a hold on a card with insufficient funds.</td></tr>
</tbody>
</table>
<table rules="none" frame="void" id="id31" class="docutils footnote">
<colgroup><col class="label"><col></colgroup>
<tbody valign="top">
<tr><td class="label"><a href="#id29" class="fn-backref">[3]</a></td><td>To simulate a card which cannot be tokenized but passes a LUHN check. You could
expect this failure when a user tried to enter in a credit card which used to
work but has been canceled.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="id32"></span>Best Practices<a href="#id32" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<div class="section">
<h3><span class="bookmark" id="using-meta-for-custom-annotation"></span>Using Meta for Custom Annotation<a href="#using-meta-for-custom-annotation" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>The <tt class="docutils literal"><span class="pre">meta</span></tt> field exists on all resources in the Balanced API. It may be used
as a dictionary of arbitrary key/value pairs, where each key and value is a
string of length 255 characters or less. This may be used to, e.g., annotate
accounts in our system with the account name on your system, or annotate
transactions with order numbers. The format is generally up to you, except in
the case of...</p>
</div>
<div class="section">
<h3><span class="bookmark" id="using-meta-for-fraud"></span>Using Meta for Fraud<a href="#using-meta-for-fraud" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Balanced reserves some keys in the <tt class="docutils literal"><span class="pre">meta</span></tt> field. These are fields that may be
passed in by you in order to help fight fraud.</p>
<div class="section">
<h4><span class="bookmark" id="shipping-address"></span>Shipping Address<a href="#shipping-address" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>You may supply shipping fulfillment information by prefixing keys
specifying address data with the <tt class="docutils literal"><span class="pre">shipping.</span></tt> prefix. The specific
fields you may provide are:</p>
<ul class="simple">
<li>shipping.address.street_address</li>
<li>shipping.address.city</li>
<li>shipping.address.region</li>
<li>shipping.address.country_code</li>
<li>shipping.carrier</li>
<li>shipping.tracking_number</li>
</ul>
<p>Let's say you want to pass on shipping address, along with shipping
carrier (USPS, UPS, FedEx, etc.) and tracking number on a debit. This is
what the <tt class="docutils literal"><span class="pre">meta</span></tt> field would look like when represented as a JSON
dictionary:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">meta</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'shipping.address.street_address'</span><span class="o">:</span> <span class="s1">'801 High St'</span><span class="p">,</span>
    <span class="s1">'shipping.address.city'</span><span class="o">:</span> <span class="s1">'Palo Alto'</span><span class="p">,</span>
    <span class="s1">'shipping.address.region'</span><span class="o">:</span> <span class="s1">'CA'</span><span class="p">,</span>
    <span class="s1">'shipping.address.postal_code'</span><span class="o">:</span> <span class="s1">'94301'</span><span class="p">,</span>
    <span class="s1">'shipping.address.country_code'</span><span class="o">:</span> <span class="s1">'USA'</span><span class="p">,</span>
    <span class="s1">'shipping.carrier'</span><span class="o">:</span> <span class="s1">'FEDEX'</span><span class="p">,</span>
    <span class="s1">'shipping.tracking_number'</span><span class="o">:</span> <span class="s1">'1234567890'</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section">
<h1><span class="bookmark" id="debiting-bank-accounts"></span><span class="bookmark" id="bank-account-debits"></span>Debiting Bank Accounts<a href="#debiting-bank-accounts" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<p>Balanced allows you to debit bank accounts via ACH. In order to do this you
must first verify the bank account to ensure that you are authorized to debit
it.</p>
<p>This process of verification is done using micro-deposits. These are test
credits to the specified bank account for random amounts which must be passed
back to Balanced to verify that they were successfully received.</p>
<p>The process of verifying a bank account takes 1-2 business days since Balanced
must send the money to the bank account being verified and it must also show up
on the bank account's statement in order for you to view the amounts sent.</p>
<p>We have complete examples for both the Python and Ruby client libraries:</p>
<ul class="simple">
<li><a href="https://github.com/balanced/balanced-python/blob/master/examples/bank_account_debits.py" class="reference external">Complete example using Python</a></li>
<li><a href="https://github.com/balanced/balanced-ruby/blob/master/examples/bank_account_debits.rb" class="reference external">Complete example using Ruby</a></li>
</ul>
<div class="section">
<h2><span class="bookmark" id="id37"></span>Tutorial<a href="#id37" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>At a high level, we're going to implement the process for verifying and
debiting a bank account. Before you begin, we recommend that you look at how
to <a href="https://docs2.balancedpayments.com/overview?language=bash#id2" class="reference external">collect bank account information tutorial</a>.</p>
<p>Here's how we're going to accomplish this:</p>
<ul class="simple">
<li><a href="#create-a-bank-account-verification" class="reference internal">Create a bank account verification</a></li>
<li><a href="#confirm-the-bank-account-verification" class="reference internal">Confirm the bank account verification</a></li>
<li><a href="#debit-the-bank-account" class="reference internal">Debit the bank account</a></li>
</ul>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To learn how to collect bank account information check out the
<a href="https://docs2.balancedpayments.com/overview?language=bash#id2" class="reference external">collect bank account information tutorial</a></p>
</div>
<div class="section">
<h3><span class="bookmark" id="create-a-bank-account-verification"></span>Create a bank account verification<a href="#create-a-bank-account-verification" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Creating a bank account verification is done via the <cite>verify</cite> operation on any
bank account via the client libraries or directly via the HTTP API.</p>
<p>The side effect of creating this resource is to generate two small
(under $1 USD) deposits to the bank account in question. These should appear in
the bank account within 2 business days and need to be reported back as
discussed in the <a href="#confirm-the-bank-account-verification" class="reference internal">Confirm the bank account verification</a> section.</p>
<ul class="simple">
<li><a href="https://docs2.balancedpayments.com/api?language=python#verifying-a-bank-account" class="reference external">Create a verification using Python</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=ruby#verifying-a-bank-account" class="reference external">Create a verification using Ruby</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=php#verifying-a-bank-account" class="reference external">Create a verification using PHP</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=bash#verifying-a-bank-account" class="reference external">Create a verification using REST API</a></li>
</ul>
</div>
<div class="section">
<h3><span class="bookmark" id="confirm-the-bank-account-verification"></span>Confirm the bank account verification<a href="#confirm-the-bank-account-verification" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Once you have the two deposit amounts you must update the verification object.
You have 3 attempts to get this right, after the 3rd unsuccessful attempt you
must create a new verification and begin the process over again. If you
successfully confirm the amounts on the verification the bank account is
automatically made available for debiting.</p>
<ul class="simple">
<li><a href="https://docs2.balancedpayments.com/api?language=python#confirm-a-bank-account-verification" class="reference external">Confirm a bank account verification using Python</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=ruby#confirm-a-bank-account-verification" class="reference external">Confirm a bank account verification using Ruby</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=php#confirm-a-bank-account-verification" class="reference external">Confirm a bank account verification using PHP</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=bash#confirm-a-bank-account-verification" class="reference external">Confirm a bank account verification using REST API</a></li>
</ul>
</div>
<div class="section">
<h3><span class="bookmark" id="debit-the-bank-account"></span>Debit the bank account<a href="#debit-the-bank-account" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Debiting a bank account is exactly the same as charging a card. We have
examples for the various client libraries, if you're directly interacting with
the REST API then simply POST to the <cite>debits_uri</cite> for your marketplace and pass
through the URI of your bank account as the <cite>source_uri</cite> attribute.</p>
<ul class="simple">
<li><a href="https://docs2.balancedpayments.com/api?language=python#create-a-new-debit" class="reference external">Debit bank account using Python</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=ruby#create-a-new-debit" class="reference external">Debit bank account using Ruby</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=php#create-a-new-debit" class="reference external">Debit bank account using PHP</a></li>
<li><a href="https://docs2.balancedpayments.com/api?language=bash#create-a-new-debit" class="reference external">Debit bank account using REST API</a></li>
</ul>
</div>
</div>
</div>
<div class="section">
<h1><span class="bookmark" id="id38"></span><span class="bookmark" id="id39"></span>Marketplaces<a href="#id38" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<p>Running a successful marketplaces typically requires combinations of both
<a href="#id16" class="reference internal"><em>Balanced Processing</em></a>, accepting credit cards, and <a href="#id4" class="reference internal"><em>Balanced Payouts</em></a>, paying out your
sellers and service providers. When those two disjoint services are coupled
as a means to collect money on behalf of someone else, i.e. a seller or
service provider, then that classifies as <em class="xref std std-term">aggregation</em> - something that
all the credit card networks such as Visa, American Express, MasterCard, etc.
frown upon and causes risk of merchant account termination, consequently,
leaving your business without a way to process online transactions.</p>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p class="last">From here on out, we will refer to your seller / service provider as a
<strong>merchant</strong>. Learn more about <em class="xref std std-term">merchants</em>.</p>
</div>
<p>Balanced allows you to mitigate this risk by exposing a programmatic merchant
underwriting API to easily create merchant accounts. Most merchants will
never have to leave your site. This makes it easy to accept payments on behalf
of your merchants, while keeping your accounting sane.</p>
<p>Let's get started!</p>
<div class="section">
<h2><span class="bookmark" id="merchant-underwriting"></span>Merchant Underwriting<a href="#merchant-underwriting" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Underwriting merchants involves every merchant to go through Know Your Customer
(KYC) regulations, which is required by the U.S. government for purposes of
Anti-Money Laundering (AML). This process is generally simple, and for most
merchants requires very little information.</p>
<div class="section">
<h3><span class="bookmark" id="collecting-merchant-information"></span>Collecting Merchant Information<a href="#collecting-merchant-information" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
</div>
<div class="section">
<h3><span class="bookmark" id="sign-up-process-api"></span>Sign-up process (API)<a href="#sign-up-process-api" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Collecting merchant information requires slightly different information
depending on if the merchant is being underwritten as a person or as a
business.</p>
<div class="section">
<h4><span class="bookmark" id="person"></span>Person<a href="#person" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<div class="section">
<h5><span class="bookmark" id="business"></span>Business<a href="#business" class="headerlink" title="Permalink to this headline">&#8757;</a></h5>
</div>
</div>
</div>
<div class="section">
<h3><span class="bookmark" id="on-success-201-created"></span>On Success (201 CREATED)<a href="#on-success-201-created" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>If identification and verification was successful, Balanced will return
a <strong>201</strong> status code</p>
</div>
<div class="section">
<h3><span class="bookmark" id="on-failure-300-multiple-choices"></span>On Failure (300 MULTIPLE CHOICES)<a href="#on-failure-300-multiple-choices" class="headerlink" title="Permalink to this headline">&#8757;</a></h3>
<p>Occasionally, the information passed to Balanced for merchant underwriting will
be insufficient to identify them, and Balanced will return a <strong>300</strong> status
code.</p>
<p>We specifically return <strong>300</strong> status code because you have multiple choices
-- you may either re-submit the original request along with more identifying
information (e.g. <tt class="docutils literal"><span class="pre">tax_id</span></tt>), <strong>or</strong> you may redirect the user to the
location specified in the redirect, where Balanced will ask for more
information to verify the user's identity with state and federal databases.</p>
<p>If you choose to submit more information, then simply repeat the above
flow with corrected or additional information.</p>
<p>However, if you choose to redirect them for Balanced to underwrite them, the
following section will alleviate the process.</p>
<div class="section">
<h4><span class="bookmark" id="redirect"></span>Redirect<a href="#redirect" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>The location you may redirect the user to is stored in the <tt class="docutils literal"><span class="pre">Location</span></tt>
header in the response to your request. You must include a
<tt class="docutils literal"><span class="pre">redirect_uri</span></tt> parameter along with the original URL so Balanced knows where
to return the user to once they have completed the underwriting process.</p>
<p>Additionally, you may pre-fill the form for the user by encoding the
original JSON payload as query string parameters.</p>
<p>The encoding should follow the form of <tt class="docutils literal"><span class="pre">merchant[key]=value</span></tt> e.g.:</p>
<div class="highlight-javascript"><pre>?merchant[type]=business&amp;email_address=merchant@example.org&amp;merchant[phone_number]=9046281796&amp;redirect_uri=https://yoursite.com/verify</pre>
</div>
</div>
<div class="section">
<h4><span class="bookmark" id="handling-redirect-response"></span>Handling Redirect Response<a href="#handling-redirect-response" class="headerlink" title="Permalink to this headline">&#8757;</a></h4>
<p>After the user has been redirected to Balanced and if the merchant was
successfully underwritten, Balanced will redirect the user to your specified
<tt class="docutils literal"><span class="pre">redirect_uri</span></tt> with <strong>two</strong> parameters appended as query strings.</p>
<p>Those are are <tt class="docutils literal"><span class="pre">email_address</span></tt> and <tt class="docutils literal"><span class="pre">merchant_uri</span></tt>.</p>
<div class="alert alert-info admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You <strong>MUST</strong> submit these two parameters to successfully create the merchant
account.</p>
</div>
</div>
</div>
</div>
<div class="section">
<h2><span class="bookmark" id="associating-debits-with-a-merchant"></span>Associating debits with a merchant<a href="#associating-debits-with-a-merchant" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>In order to stay compliant and to provide evidence that you're not aggregating,
when charging cards on your marketplace, all associated charges should be done
on behalf of the merchant. You must associate charges with the merchant's
account - this is very easy, simply pass the merchant account's <tt class="docutils literal"><span class="pre">uri</span></tt> via
the <tt class="docutils literal"><span class="pre">on_behalf_of</span></tt> parameter on the charge you're issuing.</p>
<p>The benefits of this are clearly obvious - in order to determine how much money
you owe a specific merchant, you can easily query and all the outstanding debits
tied to this merchant and subtract the payouts you've already done to the
merchant.</p>
<p>This dramatically simplifies your book-keeping and allows Balanced to take
care of most of the accounting work -- like end of year taxes, reserves, cash
flow, and operating capital.</p>
</div>
</div>
<div class="section">
<h1><span class="bookmark" id="references"></span>References<a href="#references" class="headerlink" title="Permalink to this headline">&#8757;</a></h1>
<div class="section">
<h2><span class="bookmark" id="storing-the-uri-vs-id"></span><span class="bookmark" id="uri-vs-id"></span>Storing the URI vs ID<a href="#storing-the-uri-vs-id" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Do you store the <tt class="docutils literal"><span class="pre">uri</span></tt> or the <tt class="docutils literal"><span class="pre">id</span></tt> in your database? <strong>Always, always
store the uri</strong>.</p>
<p>The <tt class="docutils literal"><span class="pre">uri</span></tt> stands for <strong>u</strong>niversal <strong>r</strong>esource <strong>i</strong>dentifier and it's
exactly what it is. An identifier.</p>
<p>Do not attempt to be clever and try to save a few bytes by storing the <tt class="docutils literal"><span class="pre">id</span></tt>
and constructing the <tt class="docutils literal"><span class="pre">uri</span></tt> later.</p>
<p>This will almost always lead to disaster. A <tt class="docutils literal"><span class="pre">uri</span></tt> is opaque and Balanced
reserves the right to use HTTP semantics later to change them, so you
should <strong>NEVER</strong> store the <tt class="docutils literal"><span class="pre">id</span></tt>.</p>
<p>Fun fact: our internal statistics show that client libraries that construct
the <tt class="docutils literal"><span class="pre">uri</span></tt> receive roughly 2 orders of magnitude more <tt class="docutils literal"><span class="pre">404</span></tt> status codes
from Balanced than clients which use the <tt class="docutils literal"><span class="pre">uri</span></tt> directly.</p>
</div>
<div class="section">
<h2><span class="bookmark" id="id40"></span>Old Documentation<a href="#id40" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Our old documentation is located at <a href="https://docs2.balancedpayments.com/api?old" class="reference external">https://docs2.balancedpayments.com/api?old</a></p>
</div>
<div class="section">
<h2><span class="bookmark" id="api-reference"></span>API Reference<a href="#api-reference" class="headerlink" title="Permalink to this headline">&#8757;</a></h2>
<p>Our API reference is located at <a href="#id80"><span id="id81" class="problematic">`https://docs2.balancedpayments.com/api?&lt;https://docs2.balancedpayments.com/api?`_</span></a></p>
</div>
</div>

</article></div></div></div>

</div>

